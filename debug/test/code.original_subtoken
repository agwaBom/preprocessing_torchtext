def resource patch context data dict check access 'resource patch' context data dict show context {'model' context['model'] 'session' context['session'] 'user' context['user'] 'auth user obj' context['auth user obj']}resource dict get action 'resource show' show context {'id' get or bust data dict 'id' } patched dict resource dict patched update data dict return update resource update context patched
def pyramid laplacian image max layer -1 downscale 2 sigma None order 1 mode 'reflect' cval 0 check factor downscale image img as float image if sigma is None sigma 2 * downscale / 6 0 layer 0rows image shape[ 0 ]cols image shape[ 1 ]smoothed image smooth image sigma mode cval yield image - smoothed image while layer max layer layer + 1out rows math ceil rows / float downscale out cols math ceil cols / float downscale resized image resize smoothed image out rows out cols order order mode mode cval cval smoothed image smooth resized image sigma mode cval prev rows rowsprev cols colsrows resized image shape[ 0 ]cols resized image shape[ 1 ]if prev rows rows and prev cols cols break yield resized image - smoothed image
def get fun fun with get serv ret None commit True as cur sql 'SELEC Ts id s jid s full ret\n FRO Msalt returnss\n JOIN SELECTMAX `jid` asjid\nfromsalt returns GROUPB Yfun id max\n O Ns jid max jid\n WHER Es fun %s\n'cur execute sql fun data cur fetchall ret {}if data for minion full ret in data ret[minion] full retreturn ret
def get svc avail path return AVAIL SVR DIRS
def store temp file filedata filename path None filename get filename from path filename filename filename[ 100 ]options Config if path target path pathelse tmp path options cuckoo get 'tmppath' '/tmp' target path os path join tmp path 'cuckoo-tmp' if not os path exists target path os mkdir target path tmp dir tempfile mkdtemp prefix 'upload ' dir target path tmp file path os path join tmp dir filename with open tmp file path 'wb' as tmp file if hasattr filedata 'read' chunk filedata read 1024 while chunk tmp file write chunk chunk filedata read 1024 else tmp file write filedata return tmp file path
def create Target Dirs if not os path isdir paths POCSUITE OUTPUT PATH try if not os path isdir paths POCSUITE OUTPUT PATH os makedirs paths POCSUITE OUTPUT PATH 493 warn Msg "using'%s'astheoutputdirectory" % paths POCSUITE OUTPUT PATH logger log CUSTOM LOGGING WARNING warn Msg except OS Error IO Error as ex try temp Dir tempfile mkdtemp prefix 'pocsuiteoutput' except Exception as err Msg "unabletowritetothetemporarydirectory '%s' " % err Msg + ' Pleasemakesurethatyourdiskisnotfulland'err Msg + 'thatyouhavesufficientwritepermissionsto'err Msg + 'createtemporaryfilesand/ordirectories'raise Pocsuite System Exception err Msg warn Msg 'unabletocreateregularoutputdirectory'warn Msg + "'%s' %s " % paths POCSUITE OUTPUT PATH get Unicode ex warn Msg + " Usingtemporarydirectory'%s'instead" % get Unicode temp Dir logger log CUSTOM LOGGING WARNING warn Msg paths POCUSITE OUTPUT PATH temp Dir
def unhex s bits 0for c in s c bytes c if '0 ' < c < '9 ' i ord '0 ' elif 'a' < c < 'f' i ord 'a' - 10 elif 'A' < c < 'F' i ord 'A' - 10 else assert False 'non-hexdigit' + repr c bits bits * 16 + ord c - i return bits
def setwindowposition folder alias x y finder getfinder args {}attrs {}aeobj 0 aetypes Object Specifier want aetypes Type 'cfol' form 'alis' seld folder alias fr None aeobj 1 aetypes Object Specifier want aetypes Type 'prop' form 'prop' seld aetypes Type 'cwnd' fr aeobj 0 aeobj 2 aetypes Object Specifier want aetypes Type 'prop' form 'prop' seld aetypes Type 'posn' fr aeobj 1 args['----'] aeobj 2args['data'] [x y] reply args attrs finder send 'core' 'setd' args attrs if args has key 'errn' raise Error aetools decodeerror args if args has key '----' return args['----']
def walk top topdown True followlinks False names os listdir top dirs nondirs [] [] for name in names if path isdir path join top name dirs append name else nondirs append name if topdown yield top dirs nondirs for name in dirs fullpath path join top name if followlinks or not path islink fullpath for x in walk fullpath topdown followlinks yield x if not topdown yield top dirs nondirs
def url filename url match upload title re match url if match return match group 'filename' else return url
@testing requires testing data@requires mnedef test other volume source spaces tempdir Temp Dir temp name op join tempdir 'temp-src fif' run subprocess ['mne volume source space' '--grid' '7 0' '--src' temp name '--mri' fname mri] src read source spaces temp name src new setup volume source space None pos 7 0 mri fname mri subjects dir subjects dir compare source spaces src src new mode 'approx' assert true 'volume shape' in repr src del srcdel src newassert raises Value Error setup volume source space 'sample' temp name pos 7 0 sphere [1 0 1 0] mri fname mri subjects dir subjects dir run subprocess ['mne volume source space' '--grid' '7 0' '--src' temp name] assert raises Value Error read source spaces temp name
def get preamble latex preamble rc Params get u'pgf preamble' u'' if type latex preamble list latex preamble u'\n' join latex preamble return latex preamble
def sdm spoly f g O K phantom None if not f or not g return sdm zero LM 1 sdm LM f LM 2 sdm LM g if LM 1 [ 0 ] LM 2 [ 0 ] return sdm zero LM 1 LM 1 [ 1 ]LM 2 LM 2 [ 1 ]lcm monomial lcm LM 1 LM 2 m1 monomial div lcm LM 1 m2 monomial div lcm LM 2 c K quo - sdm LC f K sdm LC g K r1 sdm add sdm mul term f m1 K one O K sdm mul term g m2 c O K O K if phantom is None return r1 r 2 sdm add sdm mul term phantom[ 0 ] m1 K one O K sdm mul term phantom[ 1 ] m2 c O K O K return r1 r2
def upgrade migrate engine meta Meta Data meta bind migrate enginevolume type projects Table 'volume type projects' meta autoload True if migrate engine name 'postgresql' sql 'ALTERTABL Evolume type projects ALTERCOLUM Ndeleted' + 'TYPEINTEGERUSIN Gdeleted integer' migrate engine execute sql else volume type projects c deleted alter Integer
def analyze modules project task handle taskhandle Null Task Handle resources project get python files job set task handle create jobset ' Analyzing Modules' len resources for resource in resources job set started job resource path analyze module project resource job set finished job
def get sw login version return '-' join get sw version strip build num True split '-' [1 -2 ]
def Set Help Menu Other Help main Menu global help ID Mapif help ID Map is None help ID Map {}cmd ID win 32 ui ID HELP OTHE Rexclude List [' Main Python Documentation' ' Pythonwin Reference']first List List All Help Files exclude Fnames []for desc fname in first List if desc in exclude List exclude Fnames append fname help Descs []for desc fname in first List if fname not in exclude Fnames help ID Map[cmd ID] desc fname win 32 ui Get Main Frame Hook Command Handle Help Other Command cmd ID cmd ID cmd ID + 1 help Menu main Menu Get Sub Menu main Menu Get Menu Item Count - 1 other Help Menu Pos 2other Menu help Menu Get Sub Menu other Help Menu Pos while other Menu Get Menu Item Count other Menu Delete Menu 0 win 32 con MF BYPOSITION if help ID Map for id desc fname in help ID Map iteritems other Menu Append Menu win 32 con MF ENABLED win 32 con MF STRING id desc else help Menu Enable Menu Item other Help Menu Pos win 32 con MF BYPOSITION win 32 con MF GRAYED
def to location code falcon HTTP 302 raise falcon http status HTTP Status code {'location' location}
def select command corrected commands try selector Command Selector corrected commands except No Rule Matched logs failed ' Nofucksgiven' returnif not settings require confirmation logs show corrected command selector value return selector valuelogs confirm text selector value for action in read actions if action const ACTION SELECT sys stderr write '\n' return selector valueelif action const ACTION ABORT logs failed '\n Aborted' returnelif action const ACTION PREVIOUS selector previous logs confirm text selector value elif action const ACTION NEXT selector next logs confirm text selector value
def partial project endog exog x1 x2 endog exog params np linalg pinv x2 dot x1 predicted x2 dot params residual x1 - predicted res Bunch params params fittedvalues predicted resid residual return res
def update directory composer None php None runas None prefer source None prefer dist None no scripts None no plugins None optimize None no dev None quiet False composer home '/root' result run composer 'update' directory directory extra flags '--no-progress' composer composer php php runas runas prefer source prefer source prefer dist prefer dist no scripts no scripts no plugins no plugins optimize optimize no dev no dev quiet quiet composer home composer home return result
def test On Sequence Data module dataset target dataset get Field 'target' output Module Validator calculate Module Output module dataset ends Sequence Helper get Sequence Ends dataset summed output zeros dataset outdim class output []class target []for j in range len output summed output + output[j]if j in ends class output append argmax summed output class target append argmax target[j] summed output zeros dataset outdim class output array class output class target array class target return Validator classification Performance class output class target
@retry on failuredef test inet pton if not is cli returnsocket inet pton socket AF INET '127 0 0 1' Assert Error socket error socket inet pton socket AF INET 'garbagedkfjdkfjdkfj'
def get Path edges path Indexes loop z path []for path Index Index in xrange len path Indexes path Index path Indexes[path Index Index]edge edges[path Index]carve Intersection get Carve Intersection From Edge edge loop z path append carve Intersection return path
@blueprint route '/<job id> json' methods ['GET'] @blueprint route '/<job id>' methods ['GET'] def show job id job scheduler get job job id if job is None raise werkzeug exceptions Not Found ' Jobnotfound' related jobs scheduler get related jobs job if request wants json return flask jsonify job json dict True elif isinstance job model images Image Classification Model Job return model images classification views show job related jobs related jobs elif isinstance job model images Generic Image Model Job return model images generic views show job related jobs related jobs else raise werkzeug exceptions Bad Request ' Invalidjobtype'
def test condition true false if condition return trueelse return false
def has required botocore if not HAS BOTO return Falseelif Loose Version botocore version < Loose Version required botocore version return Falseelse return True
def get load jid serv get serv ret None data serv get 'load {0 }' format jid if data return json loads data return {}
def config option show context data dict return {'success' False}
def default selem func @functools wraps func def func out image selem None *args **kwargs if selem is None selem ndi generate binary structure image ndim image ndim return func image selem selem *args **kwargs return func out
@preserve value sys 'dont write bytecode' def load module no bytecode filename module file module file path py source description sys dont write bytecode 1new module imp load module os path splitext filename [0 ] replace '-' ' ' module file module file path py source description return new module
def populate tables db prefix tmp prefix bounds bbox 'ST Set SRID ST Make Box 2 D ST Make Point % 6f % 6f ST Make Point % 6f % 6f 900913 ' % bounds db execute 'BEGIN' for table in 'point' 'line' 'roads' 'polygon' db execute 'DELETEFROM% prefix s % table sWHEREST Intersects way % bbox s ' % locals db execute 'INSERTINTO% prefix s % table s\n SELECT*FROM% tmp prefix s % table s\n WHEREST Intersects way % bbox s ' % locals db execute 'COMMIT'
def is 1pexp t only process constants True if t owner and t owner op tensor add scalars scalar inputs nonconsts opt scalarconsts rest t owner inputs only process constants only process constants if len nonconsts 1 maybe exp nonconsts[ 0 ]if maybe exp owner and maybe exp owner op tensor exp if scalars scal sum scalars[ 0 ]for s in scalars[ 1 ] scal sum scal sum + s if numpy allclose scal sum 1 return False maybe exp owner inputs[ 0 ] if config warn identify 1pexp bug warnings warn " Althoughyourcurrentcodeisfine pleasenotethat Theanoversionspriorto 0 5 morespecifically priortocommit 7987 b 51 on 2011 - 12 - 18 mayhaveyieldedanincorrectresult Toremovethiswarning eithersetthe`warn identify 1pexp bug`configoptionto False or`warn ignore bug before`toatleast' 0 4 1' " return None
def round if near integer a epsilon 0 0001 if abs a - round a < epsilon return round a else return a
def make msgid idstring None timeval time time utcdate time strftime u'%Y%m%d%H%M%S' time gmtime timeval try pid os getpid except Attribute Error pid 1randint random randrange 100000 if idstring is None idstring u''else idstring u' ' + idstring idhost DNS NAM Emsgid u'<%s %s %s%s@%s>' % utcdate pid randint idstring idhost return msgid
def get linode id from name name nodes query 'linode' 'list' ['DATA']linode id ''for node in nodes if name node['LABEL'] linode id node['LINODEID']return linode idif not linode id raise Salt Cloud Not Found ' Thespecifiedname {0 } couldnotbefound ' format name
def did you mean units s all units deprecated units format decomposed def fix deprecated x if x in deprecated units results [ x + u' deprecated ' ]decomposed try decomposed all units[x] format decomposed if decomposed is not None results append decomposed return resultsreturn x return did you mean s all units fix fix deprecated
def write block summary report course data block summary counts unique course counts get block summary totals course data with open 'xblock summary counts csv' 'wb' as csvfile summary writer csv writer csvfile delimiter ' ' quotechar '"' quoting csv QUOTE MINIMAL summary writer writerow ['XBLOCK NAME' 'UNIQUE COURSES' 'NUM TOTAL INSTANCES'] for block type in sorted block summary counts block count block summary counts get block type summary writer writerow [block type str unique course counts[block type] str block count ] csvfile close
def test semisuper succeeds with helpers tempdir as temp env gym make ' Semisuper Pendulum Decay-v 0 ' env Monitor env temp env reset env step env action space sample env close
def is classifier estimator return getattr estimator ' estimator type' None 'classifier'
def istextfile fp blocksize 512 int 2 byte lambda x bytes x if six PY 3 else chr text characters '' join int 2 byte i for i in range 32 127 + '\n\r DCTB \x 0 c\x 08 ' try block fp read blocksize except Attribute Error try with fopen fp 'rb' as fp 2 block fp 2 read blocksize except IO Error return Falseif '\x 00 ' in block return Falseelif not block return Truetry block decode 'utf- 8 ' return Trueexcept Unicode Decode Error passnontext block translate None text characters return float len nontext / len block < 0 3
@register simple tagdef bootstrap css url return css url
def get objects obj type lst objs Fake Retrieve Result for key in db content[obj type] lst objs add object db content[obj type][key] return lst objs
def expandvars path global varprogif '$' not in path return pathif not varprog import re varprog re compile '\\$ \\w+ \\{[^}]*\\} ' i 0while True m varprog search path i if not m break i j m span 0 name m group 1 if name startswith '{' and name endswith '}' name name[ 1 -1 ]if name in os environ tail path[j ]path path[ i] + os environ[name] i len path path + tailelse i jreturn path
def get New Repository return Drill Repository
def get block types from json file xblock json file if not os path isfile xblock json file print 'x Blockconfigurationfiledoesnotexist %s' % xblock json file sys exit 2 with open xblock json file 'r' as json file type set set try json data json loads json file read except Value Error as e print 'x Blockconfigurationfiledoesnotmatchtheexpectedlayoutandismissing"data"list %s' % xblock json file sys exit e message if 'data' in json data xblock type list json data['data']for xblock in xblock type list type set add xblock['name'] return type setelse print 'x Blockconfigurationfiledoesnotmatchtheexpectedlayoutandismissing"data"list %s' % xblock json file sys exit 2
def Validate Actions In Target target target dict build file target name target dict get 'target name' actions target dict get 'actions' [] for action in actions action name action get 'action name' if not action name raise Gyp Error " Anonymousactionintarget%s Anactionmusthavean'action name'field " % target name inputs action get 'inputs' None if inputs is None raise Gyp Error ' Actionintarget%shasnoinputs ' % target name action command action get 'action' if action command and not action command[ 0 ] raise Gyp Error ' Emptyactionascommandintarget%s ' % target name
def match hostname cert hostname if not cert raise Value Error u'emptyornocertificate' dnsnames []san cert get u'subject Alt Name' for key value in san if key u'DNS' if dnsname match value hostname returndnsnames append value if not dnsnames for sub in cert get u'subject' for key value in sub if key u'common Name' if dnsname match value hostname returndnsnames append value if len dnsnames > 1 raise Certificate Error u"hostname%rdoesn'tmatcheitherof%s" % hostname u' ' join map repr dnsnames elif len dnsnames 1 if sys version info[ 3] < 2 7 3 and dnsnames[ 0 ] u'calibre-ebook com' returnraise Certificate Error u"hostname%rdoesn'tmatch%r" % hostname dnsnames[ 0 ] else raise Certificate Error u'noappropriatecommon Nameorsubject Alt Namefieldswerefound'
def gf quo ground f a p K return gf mul ground f K invert a p p K
def do search conf connargs {}for name in ['server' 'port' 'tls' 'binddn' 'bindpw' 'anonymous'] connargs[name] config name conf if connargs['binddn'] and connargs['bindpw'] connargs['anonymous'] Falsetry filter conf['filter']except Key Error raise Salt Invocation Error 'missingfilter' dn config 'dn' conf scope config 'scope' conf lists config 'lists' conf or [] attrs config 'attrs' conf or [] attrs lists + attrs if not attrs attrs Nonetry result salt ['ldap search'] filter dn scope attrs **connargs ['results']except Index Error log debug 'LDA Psearchreturnednoresultsforfilter{ 0 }' format filter result {}except Exception log critical ' Failedtoretrievepillardatafrom LDAP \n' exc info True return {}return result
def test rus fit rus Random Under Sampler random state RND SEED rus fit X Y assert equal rus min c 0 assert equal rus maj c 1 assert equal rus stats c [0 ] 3 assert equal rus stats c [1 ] 7
def Missing Metrics Criteria return [] []
def Flag Overrider **flag kwargs def Decorator f ' Allowafunctiontosafelychangeflags restoringthemonreturn 'def Decorated *args **kwargs global FLAG Sold flags copy copy FLAGS for k v in flag kwargs items setattr FLAGS k v try return f *args **kwargs finally FLAGS old flagsreturn Decoratedreturn Decorator
def follow link connection link if link return connection follow link link else return None
def add arg f *args **kwargs if not hasattr f 'arguments' f arguments []if args kwargs not in f arguments f arguments insert 0 args kwargs
def singleton cls instances {}def get instance *args **kwargs if cls not in instances instances[cls] cls *args **kwargs return instances[cls]return get instance
def get pseudo pgp block remaining contents if not remaining contents return Noneblock match PGP BLOCK START match remaining contents[ 0 ] if block match block type block match groups [0 ]block lines []end line PGP BLOCK END % block type while True if not remaining contents raise Value Error " Unterminatedpgpstyleblock lookingfor'%s' \n%s" % end line '\n' join block lines line remaining contents pop 0 block lines append line if line end line return block type '\n' join block lines else return None
def plugin cache dir return os path join tempfile gettempdir ' Ulti Snips test vim plugins'
def keywords text NUM KEYWORDS 10 text split words text if text num words len text text [x for x in text if x not in stopwords ]freq {}for word in text if word in freq freq[word] + 1else freq[word] 1min size min NUM KEYWORDS len freq keywords sorted freq items key lambda x x[ 1 ] x[ 0 ] reverse True keywords keywords[ min size]keywords dict x y for x y in keywords for k in keywords article Score keywords[k] * 1 0 / max num words 1 keywords[k] article Score * 1 5 + 1 return dict keywords else return dict
def escape s if s is None return ''assert isinstance s basestring 'expected%sbutgot%s value %s' % basestring type s s s s replace '\\' '\\\\' s s replace '\n' '\\n' s s replace ' DCTB ' '\\t' s s replace ' ' ' DCTB ' return s
def after script destroy cmd ['terraform' 'destroy' '-force']logging info ' Destroyingcloudproviderresources' sys exit run cmd destroy cmd
def standard b64 encode s return b64 encode s
def import buffer to ast buf module name return hy compile import buffer to hst buf module name
def merge with func *dicts **kwargs if len dicts 1 and not isinstance dicts[ 0 ] dict dicts dicts[ 0 ]factory get factory merge with kwargs result factory for d in dicts for k v in iteritems d if k not in result result[k] [v]else result[k] append v return valmap func result factory
def text List To Colors Simple names u Names list set names u Names sort text To Color [u Names index n for n in names]text To Color np array text To Color text To Color 255 * text To Color - text To Color min / text To Color max - text To Color min textmaps generate Color Map colors [textmaps[int c ] for c in text To Color]return colors
def multidict to dict multidict if config AUTO COLLAPSE MULTI KEYS d dict multidict lists for key value in d items if len value 1 d[key] value[ 0 ]return delse return multidict to dict
def get can enable ldap if has module u'ldap' return True None else return False u'LDA Pauthenticationrequiresthepython-ldaplibrary whichisnotinstalled '
def escape all v linkify True if isinstance v basestring v jinja 2 escape smart unicode v if linkify v bleach linkify v callbacks [bleach callbacks nofollow] return velif isinstance v list for i lv in enumerate v v[i] escape all lv linkify linkify elif isinstance v dict for k lv in v iteritems v[k] escape all lv linkify linkify elif isinstance v Translation v jinja 2 escape smart unicode v localized string return v
def strip html unclean if not isinstance unclean basestring and not is iterable unclean and unclean is not None return uncleanreturn bleach clean unclean strip True tags [] attributes [] styles []
def get ident return -1
def get health **kwargs with Ipmi Command **kwargs as s return s get health
def isunauthenticated f return getattr f 'unauthenticated' False
def agent leave consul url None node None ret {}query params {}if not consul url consul url get config if not consul url log error ' No Consul UR Lfound ' ret['message'] ' No Consul UR Lfound 'ret['res'] Falsereturn retif not node raise Salt Invocation Error ' Requiredargument"node"ismissing ' function 'agent/force-leave/{ 0 }' format node res query consul url consul url function function method 'GET' query params query params if res['res'] ret['res'] Trueret['message'] ' Node{ 0 }putinleavestate ' format node else ret['res'] Falseret['message'] ' Unabletochangestatefor{ 0 } ' format node return ret
def make dist name version **kwargs summary kwargs pop u'summary' u' Placeholderforsummary' md Metadata **kwargs md name namemd version versionmd summary summary or u' Plaeholderforsummary' return Distribution md
def task cli pip prereqs package manager if package manager in 'dnf' 'yum' return yum install PIP CLI PREREQ YUM package manager package manager sudo True elif package manager 'apt' return sequence [apt get update sudo True apt get install PIP CLI PREREQ APT sudo True ] else raise Unsupported Distribution
@publicdef pdiv f g *gens **args options allowed flags args ['polys'] try F G opt parallel poly from expr f g *gens **args except Polification Failed as exc raise Computation Failed 'pdiv' 2 exc q r F pdiv G if not opt polys return q as expr r as expr else return q r
def count values expr sort True result by expr count expr count if sort result result sort 'count' ascending False return result
def pairwise most common sets from sympy utilities iterables import subsetsfrom collections import defaultdictmost -1 for i j in subsets list range len sets 2 com sets[i] & sets[j] if com and len com > most best defaultdict list best keys []most len com if len com most if com not in best keys best keys append com best[best keys index com ] append i j if most -1 return []for k in range len best best keys[k] best keys[k] best[k] best keys sort key lambda x len x[ 1 ] return best keys
def yaml dump object yaml get yaml return yaml dump object Dumper yaml Round Trip Dumper block seq indent 2 default flow style False indent 2
def serve file load fnd if 'env' in load salt utils warn until ' Oxygen' " Parameter'env'hasbeendetectedintheargumentlist Thisparameterisnolongerusedandhasbeenreplacedby'saltenv'asof Salt 2016 11 0 Thiswarningwillberemovedin Salt Oxygen " load pop 'env' ret {'data' '' 'dest' ''}if 'path' not in load or 'loc' not in load or 'saltenv' not in load return retif not fnd['path'] return retret['dest'] fnd['rel']gzip load get 'gzip' None with salt utils fopen os path normpath fnd['path'] 'rb' as fp fp seek load['loc'] data fp read opts ['file buffer size'] if gzip and data data salt utils gzip util compress data gzip ret['gzip'] gzipret['data'] datareturn ret
def skip reason def decorator test item if not isinstance test item type types Class Type @functools wraps test item def skip wrapper *args **kwargs raise Skip Test reason test item skip wrappertest item unittest skip Truetest item unittest skip why reasonreturn test itemreturn decorator
def setup platform hass config add devices discovery info None devs config get CONF DEVICES add devices [ Mochad Switch hass mochad CONTROLLER ctrl dev for dev in devs] return True
def test boolean assert hug types boolean '1 ' assert hug types boolean 'T' assert not hug types boolean '' assert hug types boolean ' False' assert not hug types boolean False
def jet rc 'image' cmap 'jet' im gci if im is not None im set cmap cm jet draw if interactive
def pperm accessing obj accessed obj *args **kwargs return perm to player accessing obj accessed obj *args **kwargs
def unregister hosting service name try hosting service registry unregister by attr u'hosting service id' name except Item Lookup Error as e logging error u' Failedtounregisterunknownhostingservice"%s"' % name raise e
def reconn notice guide light magenta ' Youcanuse' + light green 'switch' + light magenta 'commandtoreturntoyourstream \n' guide + light magenta ' Type' + light green 'hstream' + light magenta 'formoredetails ' print Nicely guide sys stdout write g['decorated name'] g['PREFIX'] sys stdout flush
def runproc cmd proc Popen [cmd] shell True stdin PIPE stdout PIPE stderr PIPE close fds True stdoutdata stderrdata proc communicate return stdoutdata stderrdata
def convert unreachable exception e error format u' Facebookisunreachable%s' exception class map unreachable exception e error message error format % str e exception exception class error message return exception
def init pool worker signal signal signal SIGINT signal SIG IGN
def output data **kwargs return salt utils locales sdecode str data
def count ngrams text max ngram size stop words if not isinstance stop words set stop words set stop words words [word lower for word in WORD RE findall text if word lower not in stop words ]ngram counts defaultdict int for i in range len words for n in range 1 max ngram size + 1 if i + n < len words ngram '' join words[i i + n ] ngram counts[ n ngram ] + 1for n in range 1 max ngram size + 1 ngram counts[ n None ] len words - n + 1 return ngram counts
def filepath to uri path if path is None return pathreturn urllib quote smart str path replace '\\' '/' safe "/~ * '"
def Format Code unformatted source filename '<unknown>' style config None lines None print diff False verify False Check Python Version style Set Global Style style Create Style From Config style config if not unformatted source endswith '\n' unformatted source + '\n'tree pytree utils Parse Code To Tree unformatted source comment splicer Splice Comments tree continuation splicer Splice Continuations tree subtype assigner Assign Subtypes tree split penalty Compute Split Penalties tree blank line calculator Calculate Blank Lines tree uwlines pytree unwrapper Unwrap Py Tree tree for uwl in uwlines uwl Calculate Formatting Information Mark Lines To Format uwlines lines reformatted source reformatter Reformat uwlines verify if unformatted source reformatted source return '' if print diff else reformatted source False code diff Get Unified Diff unformatted source reformatted source filename filename if print diff return code diff code diff '' return reformatted source True
@step ' Iwillconfirmallalerts' def i confirm all alerts step world browser execute script 'window confirm function {returntrue } window alert function {return }'
def get text original token replace if replace return token textelse return original[token startchar token endchar]
def test ranking ignores identifier quotes completer text u'user'collection [u'user action' u'"user"']matches completer find matches text collection assert len matches 2
def temp file for path ext os path splitext path [1 ]with Named Temporary File suffix ext delete False as f return f name
def token urlsafe nbytes None tok token bytes nbytes return base 64 urlsafe b64 encode tok rstrip ' ' decode 'ascii'
def setup logger logger stream filename None fmt None if len logger handlers < 1 console logging Stream Handler stream console set Level logging DEBUG console set Formatter logging Formatter fmt logger add Handler console logger set Level logging DEBUG if filename outfile logging File Handler filename outfile set Level logging INFO outfile set Formatter logging Formatter '% asctime s' + fmt if fmt else '% message s' logger add Handler outfile
def saturated color factor 150 h color hsv Hue F s color hsv Saturation F v color value F a color alpha F s factor * s / 100 0 s max min 1 0 s 0 0 return Q Color from Hsv F h s v a convert To color spec
def absolute path path relative to None if path and os path isabs path return pathif path and relative to is not None abspath os path join relative to path if os path isfile abspath log debug " Relativepath'{ 0 }'convertedtoexistingabsolutepath'{ 1 }'" format path abspath return abspathreturn path
def lonlat 2 grid lon lat return '%d%s' % lon 2 zone lon lat 2 zone lat
def create continuous query database name query **client args client client **client args full query 'CREATECONTINUOUSQUERY{ 0 }ON{ 1 }BEGIN{ 2 }END'query full query format name database query client query query return True
def iso now now datetime datetime now return '%s %06 d' % now strftime '%Y%m%d %H%M%S' now microsecond
@flaskbb group def plugins pass
def idz frmi m return id idz frmi m
def run gdb *args **env vars if env vars env os environ copy env update env vars else env Nonebase cmd 'gdb' '--batch' if gdb major version gdb minor version > 7 4 base cmd + '-iex' 'add-auto-load-safe-path' + checkout hook path out err subprocess Popen base cmd + args stdout subprocess PIPE stderr subprocess PIPE env env communicate return out err
def uninstall name version None uninstall args None override args False choc path find chocolatey context salt cmd [choc path 'uninstall' name]if version cmd extend ['--version' version] if uninstall args cmd extend ['--uninstallarguments' uninstall args] if override args cmd extend ['--overridearguments'] cmd extend yes context result salt ['cmd run all'] cmd python shell False if result['retcode'] not in [0 1605 1614 1641 ] err ' Runningchocolateyfailed {0 }' format result['stdout'] raise Command Execution Error err return result['stdout']
def write key file key filename banner public key secret key None metadata None encoding 'utf- 8 ' if isinstance public key bytes public key public key decode encoding if isinstance secret key bytes secret key secret key decode encoding with io open key filename 'w' encoding 'utf 8 ' as f f write banner format datetime datetime now f write u 'metadata\n' if metadata for k v in metadata items if isinstance k bytes k k decode encoding if isinstance v bytes v v decode encoding f write u '{ 0 } {1 }\n' format k v f write u 'curve\n' f write u 'public-key "{ 0 }"\n' format public key if secret key f write u 'secret-key "{ 0 }"\n' format secret key
def get fasta labels input fasta fp fasta labels []fasta f open input fasta fp 'U' for label seq in parse fasta fasta f fasta labels append label split [0 ] return fasta labels
def n to one arr return where arr 1 [0 ][ 0 ]
def Auth Function host email passin raw input fn password input fn if not email print ' Pleaseenterlogincredentialsfor%s' % host email raw input fn ' Email ' if email password prompt ' Passwordfor%s ' % email if passin password raw input fn password prompt else password password input fn password prompt else password Nonereturn email password
def openbsd remotes on port which end remotes set try data subprocess check output ['netstat' '-nf' 'inet'] except subprocess Called Process Error log error ' Failednetstat' raiselines data split '\n' for line in lines if 'ESTABLISHED' not in line continuechunks line split local host local port chunks[ 3 ] rsplit ' ' 1 remote host remote port chunks[ 4 ] rsplit ' ' 1 if which end 'remote port' and int remote port port continueif which end 'local port' and int local port port continueremotes add remote host return remotes
def lpmerge L R setitem L setitem [setitem k v for k v in items R if v is not None ]return L
def get mac address conn domain name domain conn lookup By Name domain name domain xml domain XML Desc domain tree etree fromstring domain xml devices domain tree find 'devices' interfaces devices iterfind 'interface' for interface in interfaces source interface find 'source' if source is None or source get 'network' 'vagrant-private-dhcp' continuemac element interface find 'mac' mac address mac element get 'address' return mac addressraise No Private DHCP Interface Exception
def cleanup version sender instance **kw if kw get 'raw' returnfor file in instance files all cleanup file file class file
def run validator file path url None temp path Nonetemp path tempfile mktemp copy stored file file path temp path src storage private storage dst storage local storage with statsd timer 'mkt developers validator' is packaged zipfile is zipfile temp path if is packaged log info u' Running`validate packaged app`forpath %s' % file path with statsd timer 'mkt developers validate packaged app' return validate packaged app temp path market urls settings VALIDATOR IAF URLS timeout settings VALIDATOR TIMEOUT spidermonkey settings SPIDERMONKEY else log info u' Running`validate app`forpath %s' % file path with statsd timer 'mkt developers validate app' return validate app open temp path read market urls settings VALIDATOR IAF URLS url url os unlink temp path
def flatten list list of list [[] []] return sum list of list []
def tosequence X if isinstance X Mapping return [X]else return tosequence X
def check path traversal path user 'root' skip perm errors False for tpath in list path traversal path if not os access tpath os R OK msg ' Couldnotaccess{ 0 } ' format tpath if not os path exists tpath msg + ' Pathdoesnotexist 'else current user salt utils get user if user current user msg + ' Tryrunningasuser{ 0 } ' format user else msg + ' Pleasegive{ 0 }readpermissions ' format user if skip perm errors returnraise Salt Client Error msg
def htmlsafe json dumps obj dumper None **kwargs if dumper is None dumper json dumpsrv dumper obj **kwargs replace u'<' u'\\u 003 c' replace u'>' u'\\u 003 e' replace u'&' u'\\u 0026 ' replace u"'" u'\\u 0027 ' return rv
def resp status property def getter self return '%s%s' % self status int self title def setter self value if isinstance value six integer types self status int valueself explanation self title RESPONSE REASONS[value][ 0 ]else if isinstance value six text type value value encode 'utf- 8 ' self status int int value split '' 1 [0 ] self explanation self title value split '' 1 [1 ]return property getter setter doc " Retrieveandsetthe Responsestatus e g '200 OK'"
def absolute flat glob pattern dirname basename os path split pattern if basename if os path exists pattern yield pattern elif os path isdir dirname yield pattern return
def working copy remote url path None branch 'default' update True use sudo False user None command if path is None path remote url split '/' [ -1 ]if is dir path use sudo use sudo mercurial pull path use sudo use sudo user user if update mercurial update path path branch branch use sudo use sudo user user elif not is dir path use sudo use sudo mercurial clone remote url path path use sudo use sudo user user mercurial update path path branch branch use sudo use sudo user user else raise Value Error ' Invalidcombinationofparameters '
def camel to underscore name import stringfor c in string ascii uppercase name name replace c ' %c' % c return name strip ' ' lower
def get Path By Prefix element Node path prefix if len path < 2 print ' Warning bug pathistoosmallinevaluateinset Path By Prefix 'returnpath By Key get Path By Key [] element Node get Capitalized Suffix Key prefix 'path' if len path By Key < len path for point Index in xrange len path By Key path[point Index] path By Key[point Index]else path path By Keypath[ 0 ] get Vector 3 By Prefix path[ 0 ] element Node get Capitalized Suffix Key prefix 'path Start' path[ -1 ] get Vector 3 By Prefix path[ -1 ] element Node get Capitalized Suffix Key prefix 'path End' return path
def filter sff reads sff data ids to keep None ids to remove None header reads sff dataif ids to keep is not None reads [r for r in reads if r[' Name'] in ids to keep ]if ids to remove is not None reads [r for r in reads if r[' Name'] not in ids to remove ]header['number of reads'] len reads return header reads
def sysctl cmd namespace None log fail as error True cmd ['sysctl' '-w'] + cmd ip wrapper IP Wrapper namespace namespace try ip wrapper netns execute cmd run as root True log fail as error log fail as error except Runtime Error as rte LOG warning LW ' Setting% cmd sinnamespace% ns sfailed % err s ' {'cmd' cmd 'ns' namespace 'err' rte} return 1return 0
def add remote path name remote url use sudo False user None fetch True if path is None raise Value Error ' Pathtotheworkingcopyisneededtoaddaremote' if fetch cmd 'gitremoteadd-f%s%s' % name remote url else cmd 'gitremoteadd%s%s' % name remote url with cd path if use sudo and user is None run as root cmd elif use sudo sudo cmd user user else run cmd
def binary search std lib sorted collection item index bisect bisect left sorted collection item if index len sorted collection and sorted collection[index] item return indexreturn None
def test rechunk 1d a np random uniform 0 1 300 x da from array a chunks 100 * 3 new 50 * 6 x2 rechunk x chunks new assert x2 chunks new assert np all x2 compute a
def memoized method func None key factory per instance **kwargs return memoized func func key factory key factory **kwargs
def rekey db packer n 0while 1 m rekey one batch db packer if m 0 breakn + mreturn n
def Filters return cpplint state filters
def placeholder shape None ndim None dtype None sparse False name None if dtype is None dtype floatx if shape is None and ndim is None raise Value Error ' Specifyeitherashapeorndimvalue ' if shape is not None ndim len shape else shape tuple [ None for in range ndim ] broadcast False * ndim if sparse assert sparse module x th sparse module csr matrix name name dtype dtype else x T Tensor Type dtype broadcast name x keras shape shapex uses learning phase Falsereturn x
def libvlc media get duration p md f Cfunctions get 'libvlc media get duration' None or Cfunction 'libvlc media get duration' 1 None ctypes c longlong Media return f p md
def initialize Zone Interval Table shape vertexes shape zone Interval shape layer Thickness / math sqrt len vertexes / 1000 0 shape z Zone Table {}for point in vertexes add To Zone Table point shape
def invitation detail request token invitation Invitation objects get invitation token if not invitation return invitation error request ' Thisinvitationisnolongervalid ' backend getattr settings 'REGISTRATION BACKEND' 'registration backends default Default Backend' return register request backend
def pipeline code wrapper pipeline code return '\nexported pipeline {}\n\nexported pipeline fit training features training classes \nresults exported pipeline predict testing features \n' format pipeline code
def expand to match items cfg 2 newlines {}for configuration lines in items cfg 2 newlines[configuration] []maxguard 2 ** 30 while True minimalsourceline maxguardfor configuration lines in items if lines minimalsourceline min minimalsourceline lines[ 0 ] sourceline if minimalsourceline maxguard breakfor configuration lines in items if lines and lines[ 0 ] sourceline < minimalsourceline cfg 2 newlines[configuration] append lines[ 0 ] del lines[ 0 ]number of lines max len x for x in cfg 2 newlines values for newlines in cfg 2 newlines values add number of lines - len newlines newlines extend ['\n'] * add return cfg 2 newlines
def del password name cmd "dscl -passwd/ Users/{ 0 }''" format name try salt utils mac utils execute return success cmd except Command Execution Error as exc if 'e DS Unknown Node Name' in exc strerror raise Command Execution Error ' Usernotfound {0 }' format name raise Command Execution Error ' Unknownerror {0 }' format exc strerror cmd "dscl -create/ Users/{ 0 } Password'*'" format name salt utils mac utils execute return success cmd return info name ['passwd'] '*'
def is suppressed warning type subtype suppress warnings if type is None return Falsefor warning type in suppress warnings if ' ' in warning type target subtarget warning type split ' ' 1 else target subtarget warning type None if target type if subtype is None or subtarget is None or subtarget subtype or subtarget '*' return Truereturn False
def count context namespace name session namespace namespace api get context namespace name session query session query func count models Metadef Tag id filter by namespace id namespace['id'] return query scalar
def first nibble hex encoding t parts []for c in t x y get nibbles c parts append '%%%X%s' % ord x y return '%' + '%' join parts
def test should report both errors and warnings negative expected [ 'cannotassignto None' ' None' -1 Error ' Variableaassignedbeforeglobaldeclaration' 'globala' -1 Warning ]code ' None 2\ndeffoo \na 2\nglobala' Assert Error Assertion Error Are Equal expected compile file code
def p constant expression opt 2 t pass
def get best match target name names exact []wildcard start []wildcard end []regex []for name in names if exact match target name name exact append name elif wildcard match target name name True wildcard start append name elif wildcard match target name name False wildcard end append name elif regex match target name name regex append name if len exact > 0 match min exact key len return 'exact' match if len wildcard start > 0 match max wildcard start key len return 'wildcard start' match if len wildcard end > 0 match max wildcard end key len return 'wildcard end' match if len regex > 0 match regex[ 0 ]return 'regex' match return None None
def parse test files option opt opt str opt if ' ' in opt f name rest opt split ' ' 1 return f name list map int rest split ' ' else return opt []
@get '/admin/<taskid>/flush' def task flush taskid if is admin taskid Data Store tasks dict else for key in list Data Store tasks if Data Store tasks[key] remote addr request remote addr del Data Store tasks[key]logger debug '[%s] Flushedtaskpool %s ' % taskid 'admin' if is admin taskid else request remote addr return jsonize {'success' True}
def test comparision with c raw events get data [ 2]c evoked read evokeds evoked nf name condition 0 epochs Epochs raw events event id tmin tmax baseline None preload True proj False evoked epochs set eeg reference apply proj average sel pick channels c evoked ch names evoked ch names evoked data evoked datac evoked data c evoked data[sel]assert true evoked nave c evoked nave assert array almost equal evoked data c evoked data 10 assert array almost equal evoked times c evoked times 12
def set Integer Value To String integer Setting value String dot Index value String find ' ' if dot Index > -1 value String value String[ dot Index]try integer Setting value int value String returnexcept print ' Warning cannotreadinteger' + integer Setting name + '' + value String print ' Willtryreadingasaboolean whichmightbeamistake 'integer Setting value 0if value String lower 'true' integer Setting value 1
def already listening psutil port renewer False try net connections psutil net connections except psutil Access Denied as error logger info ' Accessdeniedwhentryingtolistnetworkconnections %s Areyouroot?' error return Falselisteners [conn pid for conn in net connections if conn status 'LISTEN' and conn type socket SOCK STREAM and conn laddr[ 1 ] port ]try if listeners and listeners[ 0 ] is not None pid listeners[ 0 ]name psutil Process pid name display zope component get Utility interfaces I Display extra ''if renewer extra RENEWER EXTRA MS Gdisplay notification ' Theprogram{ 0 } process ID{ 1 } isalreadylisteningon TC Pport{ 2 } Thiswillpreventusfrombindingtothatport Pleasestopthe{ 0 }programtemporarilyandthentryagain {3 }' format name pid port extra force interactive True return Trueexcept psutil No Such Process psutil Access Denied passreturn False
def mw boot x y num reps 999 tol MACHEP * 100 observed stat obs p mw t x y u stats as or more extreme 0for sampled x sampled y in get bootstrap sample x y num reps try sample stat sample p mw t sampled x sampled y if sample stat < observed stat - tol u stats as or more extreme + 1except Value Error passreturn observed stat u stats as or more extreme + 1 / num reps + 1
def volume update db context volume id host cluster name volume objects Volume get by id context volume id volume host hostvolume cluster name cluster namevolume scheduled at timeutils utcnow volume save return volume
def get target ch container target picks pick channels container ch names include [target] ref picks pick types container info meg False eeg False ref meg True if len ref picks > 0 picks list set picks - set ref picks if len picks 0 raise Value Error '%snotinchannellist %s ' % target container ch names return picks
def graph atlas g return list generate graphs
def determine default project project None if project is None project get gcd project if project is None project base default project project project return project
def num cpus ncpufuncs {' Linux' num cpus unix ' Darwin' num cpus darwin ' Windows' num cpus windows}ncpufunc ncpufuncs get platform system num cpus unix try ncpus max 1 int ncpufunc except ncpus 1return ncpus
def which command path None verbose 0 exts None try match whichgen command path verbose exts next except Stop Iteration raise Which Error " Couldnotfind'%s'onthepath " % command return match
def Parse And Unwrap code dumptree False tree pytree utils Parse Code To Tree code comment splicer Splice Comments tree continuation splicer Splice Continuations tree subtype assigner Assign Subtypes tree split penalty Compute Split Penalties tree blank line calculator Calculate Blank Lines tree if dumptree pytree visitor Dump Py Tree tree target stream sys stderr uwlines pytree unwrapper Unwrap Py Tree tree for uwl in uwlines uwl Calculate Formatting Information return uwlines
def iri to uri iri if iri is None return irielif isinstance iri Promise iri str iri return quote iri safe "/#%[] $& + ?*@'~"
def test changing timer with messages shown qtbot view config stub config stub['ui']['message-timeout'] 900000 view show message usertypes Message Level info 'test' with qtbot wait Signal view clear timer timeout config stub set 'ui' 'message-timeout' 100
def convert date obj if not PY 2 and isinstance obj bytes bytearray obj obj decode 'ascii' try return datetime date *[int x for x in obj split '-' 2 ] except Value Error return None
def string from module module variable None default None val variable from module module variable variable default default if val if variable return valelse result [v for v in make iter val if isinstance v basestring ]return result if result else default return default
def upload param dict timeout data param dict['format'] 'json'param dict['wait'] 'true'param dict['bucket'] 'audio summary'result util callm 'track/upload' param dict POST True socket timeout 300 data data return track from response result timeout
def get options ret None defaults {'color' 'yellow' 'notify' False 'api url' 'api hipchat com'}attrs {'hipchat profile' 'profile' 'room id' 'room id' 'from name' 'from name' 'api key' 'api key' 'api version' 'api version' 'color' 'color' 'notify' 'notify' 'api url' 'api url'}profile attr 'hipchat profile'profile attrs {'from jid' 'from jid' 'api key' 'api key' 'api version' 'api key' 'api url' 'api url'} options salt returners get returner options virtualname ret attrs profile attr profile attr profile attrs profile attrs salt salt opts opts defaults defaults return options
def Test Data parent None source None include suites None warn on skipped False extensions None if os path isdir source return Test Data Directory parent source populate include suites warn on skipped extensions return Test Case File parent source populate
def check reg match sss py sss mf comp tol info py sss py info['proc history'][ 0 ]['max info']['sss info']assert true info py is not None assert true len info py > 0 info mf sss mf info['proc history'][ 0 ]['max info']['sss info']n in Nonefor inf in info py info mf if n in is None n in get n moments inf['in order'] else assert equal n in get n moments inf['in order'] assert equal inf['components'][ n in] sum inf['nfree'] assert allclose info py['nfree'] info mf['nfree'] atol comp tol err msg sss py filenames[ 0 ]
def safe int val allow zero True try ret int val except Value Error print " Sorry '%s'isnotavalidinteger " % val return Falseif not allow zero and ret 0 print ' Pleaseenteranon-zerointeger ' return Falsereturn ret
def pearsonr x y x np asarray x y np asarray y n len x mx x mean my y mean xm ym x - mx y - my r num np add reduce xm * ym r den np sqrt sum of squares xm * sum of squares ym r r num / r den r max min r 1 0 -1 0 df n - 2 if abs r 1 0 prob 0 0else t squared r ** 2 * df / 1 0 - r * 1 0 + r prob betai 0 5 * df 0 5 df / df + t squared return r prob
def group detail request slug template name 'groups/group detail html' group get object or 404 Group slug slug is active True if group invite only and not Group Member objects is member group request user return redirect request reverse 'groups join' kwargs {'slug' group slug} return render request template name {'group' group 'topic list' group topics all }
def security group get by names context group names query security group get query context read deleted 'no' join rules False filter by project id context project id filter models Security Group name in group names sg models query all if len sg models len group names return sg modelsgroup names from models [x name for x in sg models]for group name in group names if group name not in group names from models raise exception Security Group Not Found For Project project id context project id security group id group name
def download and extract URL if URL None logger warning ' Pleaseprovide URL' return Nonetmpdir tempfile mkdtemp filename os path basename URL path tmpdir + '/' + filename zdata urllib 2 urlopen URL print ' Savingfiletodiskpleasewait 'with open path 'wb' as local file local file write zdata read zfile zipfile Zip File path print ' Extractingzipfile'try zfile extractall tmpdir except logger warning " Couldn'textractzipfile" return Nonereturn tmpdir
def has access f if hasattr f ' permission name' permission str f permission nameelse permission str f name def wraps self *args **kwargs permission str PERMISSION PREFIX + f permission name if self appbuilder sm has access permission str self class name return f self *args **kwargs else log warning LOGMSG ERR SEC ACCESS DENIED format permission str self class name flash as unicode FLAMSG ERR SEC ACCESS DENIED 'danger' return redirect url for self appbuilder sm auth view class name + ' login' f permission name permission strreturn functools update wrapper wraps f
def shift multi x wrg 0 1 hrg 0 1 is random False row index 0 col index 1 channel index 2 fill mode 'nearest' cval 0 0 h w x[ 0 ] shape[row index] x[ 0 ] shape[col index] if is random tx np random uniform - hrg hrg * h ty np random uniform - wrg wrg * w else tx ty hrg * h wrg * w translation matrix np array [[ 1 0 tx] [0 1 ty] [0 0 1]] transform matrix translation matrixresults []for data in x results append apply transform data transform matrix channel index fill mode cval return np asarray results
def standardize structure def mutating helper structure if isinstance structure list structure sort key id or key for each in structure mutating helper each elif isinstance structure dict structure dict structure for k v in six iteritems structure mutating helper k mutating helper v new structure copy deepcopy structure mutating helper new structure return new structure
def slug validator s ok SLUG OK lower True spaces False delimiter '-' message validate slug message code validate slug code if not s and slugify s ok lower spaces delimiter s raise Validation Error message code code
def csrf request def get val token get token request if token is None return 'NOTPROVIDED'else return token get val lazy get val str return {'csrf token' get val }
def make table file lines labels dir path filename lines sort lines insert 0 ' DCTB ' join labels output open os path join dir path filename 'w' output write '\n' join lines output close
def htmldecode text if isinstance text str uchr chrelse def uchr value value > 127 and chr value or chr value def entitydecode match uchr uchr entity match group 1 if entity startswith u'#x' return uchr int entity[ 2 ] 16 elif entity startswith u'#' return uchr int entity[ 1 ] elif entity in name 2 codepoint return uchr name 2 codepoint[entity] else return match group 0 return charrefpat sub entitydecode text
def execvp file args execvpe file args
def read string fid tag shape rlims d fromstring rows fid tag size dtype '>c' shape shape rlims rlims return text type d tostring decode 'utf- 8 ' 'ignore'
def shutdown RPC port 4242 s socket socket socket AF INET socket SOCK STREAM s connect 'localhost' 4242 client symmetricjsonrpc RPC Client s client notify 'shutdown' client shutdown print '[ ] Veil- Evasion RP Cservershutdown'
def mounts cmd 'mount'ret {}out salt ['cmd run all'] cmd output out['stdout'] splitlines for line in output if not line continueif 'fuse mfs' in line comps line split '' info 1 comps[ 0 ] split ' ' info 2 info 1 [ 1 ] split '/' ret[comps[ 2 ]] {'remote' {'master' info 1 [ 0 ] 'port' info 2 [ 0 ] 'subfolder' '/' + info 2 [ 1 ] } 'local' comps[ 2 ] 'options' comps[ 5 ] replace ' ' '' replace ' ' '' split ' ' }return ret
def aware utcnow return datetime utcnow replace tzinfo utc
@register u'menu-complete-backward' def menu complete backward event event current buffer complete previous
def get Full Policy Name policy item policy name return full policy names adml data if policy name in adm policy name map[return full policy names] return adm policy name map[return full policy names][policy name]if return full policy names and 'display Name' in policy item attrib full Policy Name get Adml Display Name adml data policy item attrib['display Name'] if full Policy Name adm policy name map[return full policy names][policy name] full Policy Namepolicy name full Policy Nameelif return full policy names and 'id' in policy item attrib full Policy Name get Adml Presentation Ref Id adml data policy item attrib['id'] if full Policy Name adm policy name map[return full policy names][policy name] full Policy Namepolicy name full Policy Namepolicy name policy name rstrip ' ' rstrip return policy name
def test handshake protocol unsupported log message transport proto 'chat'message headers extend gen ws headers 'test' [0 ] with log 'aiohttp websocket' as ctx protocol do handshake message method message headers transport protocols [proto] assert protocol is None assert ctx records[ -1 ] msg ' Clientprotocols%rdon\xe 2 \x 80 \x 99 toverlapserver-knownones%r'
def get default collection bus session None try return Collection bus except Item Not Found Exception return create collection bus ' Default' 'default' session
@hgcommanddef sync ui repo **opts if codereview disabled raise hg util Abort codereview disabled if not opts['local'] if hg incoming ui repo err hg pull ui repo update True else err hg update ui repo if err return errsync changes ui repo
def split s sep None maxsplit 0 return s split sep maxsplit
def DEFINE multichoice name default choices help CONFIG Add Option type info Multi Choice name name default default choices choices description help
def file lines fname try outfile open fname except IO Error return []else out outfile readlines outfile close return out
def get git revision repopath try git programs find program 'git' assert git is not None and osp isdir osp join repopath ' git' commit programs run program git ['rev-parse' '--short' 'HEAD'] cwd repopath communicate commit commit[ 0 ] strip if PY 3 commit commit decode sys getdefaultencoding branches programs run program git ['branch'] cwd repopath communicate branches branches[ 0 ]if PY 3 branches branches decode sys getdefaultencoding branches branches split '\n' active branch [b for b in branches if b startswith '*' ]if len active branch 1 branch Noneelse branch active branch[ 0 ] split None 1 [1 ]return commit branch except subprocess Called Process Error Assertion Error Attribute Error return None None
def patch vary headers response newheaders vary []if response has header ' Vary' vary vary delim re split response[' Vary'] oldheaders dict [ el lower 1 for el in vary] for newheader in newheaders if not newheader lower in oldheaders vary append newheader response[' Vary'] ' ' join vary
def term div a b domain a lm a lc a b lm b lc bmonom monomial div a lm b lm if domain has Field if monom is not None return monom domain quo a lc b lc else return Noneelif not monom is None or a lc % b lc return monom domain quo a lc b lc else return None
def getdirs dirs [i for i in os listdir dname ]dirs filter lambda x not os path isfile os path join dname x dirs return dirs
def get template template name using None chain []engines engine list using for engine in engines try return engine get template template name except Template Does Not Exist as e chain append e raise Template Does Not Exist template name chain chain
def splittype url global typeprogif typeprog is None typeprog re compile '^ [^/ ]+ ' match typeprog match url if match scheme match group 1 return scheme lower url[ len scheme + 1 ] return None url
def posix Get Link Local I Pv 6 Addresses ret List []for interface family address in interfaces interface native String interface address native String address if family socket AF INET 6 and address startswith 'fe 80 ' ret List append '%s%%%s' % address interface return ret List
def get exploration memcache key exploration id version None if version return 'exploration-version %s %s' % exploration id version else return 'exploration %s' % exploration id
def type matches value matches append Match len matches input string len matches input string name 'type' value value
def has freesurfer return 'FREESURFER HOME' in os environ
def file list load ret []envs opts get 'azurefs envs' [] storage conn azure get storage conn opts envs[load['saltenv']] result azure list blobs storage conn storage conn container load['saltenv'] for blob in result ret append blob return ret
def get session user dept request return request user None
def detect gce environment urlopen None urlopen urlopen or urllib request urlopen try response urlopen 'http // 169 254 169 254 /' timeout 1 return response info get ' Metadata- Flavor' '' ' Google' except socket timeout logger info ' Timeoutattemptingtoreach GC Emetadataservice ' return Falseexcept urllib error URL Error as e if isinstance getattr e 'reason' None socket timeout logger info ' Timeoutattemptingtoreach GC Emetadataservice ' return False
def scp transfer transfer job def print ticks d passhost transfer job params['host']user name transfer job params['user name']password transfer job params['password']file path transfer job params['file path']if pexpect is None return dict state transfer job states ERROR info PEXPECT IMPORT MESSAGE try fh fn tempfile mkstemp except Exception as e return dict state transfer job states ERROR info ' Unabletocreatetemporaryfilefortransfer %s' % str e try cmd "scp%s@%s '%s''%s'" % user name host file path replace '' '\\' fn pexpect run cmd events {' ssword *' password + '\r\n' pexpect TIMEOUT print ticks} timeout 10 return dict state transfer job states DONE path fn except Exception as e return dict state transfer job states ERROR info ' Errorduringfiletransfer %s' % str e
def tarball local 'makestatic' local 'pythonsetup pysdist--formats gztar' capture False
def static prefix view serve **kwargs if not settings DEBUG or prefix and ' //' in prefix return []elif not prefix raise Improperly Configured ' Emptystaticprefixnotpermitted' return [url '^%s ?P<path> * $' % re escape prefix lstrip '/' view kwargs kwargs ]
@world absorbdef retry on exception func max attempts 5 ignored exceptions Stale Element Reference Exception Invalid Element State Exception attempt 0while attempt < max attempts try return func except ignored exceptions world wait 1 attempt + 1assert true attempt < max attempts ' Ranoutofattemptstoexecute{}' format func
def cpu count physical mapping {}current info {}with open binary '%s/cpuinfo' % get procfs path as f for line in f line line strip lower if not line if 'physicalid' in current info and 'cpucores' in current info mapping[current info['physicalid']] current info['cpucores']current info {}elif line startswith 'physicalid' or line startswith 'cpucores' key value line split ' DCTB ' 1 current info[key] int value return sum mapping values or None
def Get Manifest Resources filename names None languages None return winresource Get Resources filename [RT MANIFEST] names languages
def location object pos None object Carbon File FS Ref object object alias object FS New Alias Minimal if not pos return getlocation object alias return setlocation object alias pos
def get xmodule instance args request task id request info {'username' request user username 'user id' request user id 'ip' request META['REMOTE ADDR'] 'agent' request META get 'HTTP USER AGENT' '' decode 'latin 1 ' 'host' request META['SERVER NAME']}xmodule instance args {'xqueue callback url prefix' get xqueue callback url prefix request 'request info' request info 'task id' task id}return xmodule instance args
def build synset lookup imagenet metadata file lines tf gfile Fast G File imagenet metadata file 'r' readlines synset to human {}for l in lines if l parts l strip split ' DCTB ' assert len parts 2 synset parts[ 0 ]human parts[ 1 ]synset to human[synset] humanreturn synset to human
def set config defaults set cors middleware defaults
def floor to utc day value return value astimezone pytz utc replace hour 0 minute 0 second 0 microsecond 0
def get layer bytes layer arr []layer layer encode 'hex' for f s in zip layer[ 0 2] layer[ 1 2] arr append f + s return arr
def virtual if salt utils which 'firewall-cmd' return Truereturn False 'firewall-cmdisnotavailable firewalldisprobablynotinstalled '
def test double close with pipeline get cat pipeline pipeline PIPE pipeline PIPE as pl assert isinstance pl stdin pipebuf Non Block Buffered Writer assert not pl stdin closed pl stdin close assert pl stdin closedpl stdin close assert isinstance pl stdout pipebuf Non Block Buffered Reader assert not pl stdout closed pl stdout close assert pl stdout closedpl stdout close pipeline wait pl
def build docs print u' Building Docs 'print console [sys executable u'-m' u'mkdocs' u'build' u'--clean' u'-d' MKDOCS BUILD u'-f' patch doc config MKDOCS CFG ]
def R Conn *args **vars locker acquire try instance name 'redis conn ' + current request application if not hasattr R Conn instance name setattr R Conn instance name redis Strict Redis *args **vars return getattr R Conn instance name finally locker release
def list query history request DEFAULT PAGE SIZE 100 prefix 'q-'share queries request user is superuserquerydict query request GET copy if not share queries querydict query[ prefix + 'user' ] request user usernameapp name get app name request querydict query[ prefix + 'type' ] app name page filter params list query history request user querydict query DEFAULT PAGE SIZE prefix filter request GET get prefix + 'search' and request GET get prefix + 'search' or '' if request GET get 'format' 'json' resp {'queries' [massage query history for json app name query history for query history in page object list]}return Json Response resp return render 'list history mako' request {'request' request 'page' page 'filter params' filter params 'share queries' share queries 'prefix' prefix 'filter' filter}
def test sample supervised idxs None noisy True with open 'gsn sup example pkl' as f gsn pickle load f gsn corrupt switch noisyds MNIST which set 'test' if idxs is None data ds X[ 100 150 ]else data ds X[idxs]samples gsn get samples [ 0 data ] indices [0 2] walkback 21 symbolic False include first True stacked vis samples samples tiled image tile raster images stacked img shape [28 28 ] tile shape [50 50 ] tile spacing 2 2 image save 'gsn sup example png' tiled
def test format docstrings try verify format docstrings except Skip Test as e import tracebacktraceback print exc e raise Assertion Error ' Somefileraised Skip Testonimport andinadvertentlycanceledthedocumentationtesting '
def list windows profile None api key None return salt utils pagerduty list items 'maintenance windows' 'id' salt ['config option'] profile api key opts opts
def run stddev tests if settings DATABASES[DEFAULT DB ALIAS]['ENGINE'] 'django db backends sqlite 3 ' return Falseclass Std Dev Pop object sql function 'STDDEV POP'try connection ops check aggregate support Std Dev Pop except return Falsereturn True
@handle response format@treeio login requireddef asset edit request asset id response format 'html' asset get object or 404 Asset pk asset id if request POST if 'cancel' not in request POST form Asset Form request user profile request POST instance asset if form is valid asset form save return Http Response Redirect reverse 'finance asset view' args [asset id] else return Http Response Redirect reverse 'finance asset view' args [asset id] else form Asset Form request user profile instance asset return render to response 'finance/asset edit' {'form' form 'asset' asset} context instance Request Context request response format response format
def api model exists rest Api Id model Name region None key None keyid None profile None r describe api model rest Api Id model Name region region key key keyid keyid profile profile return {'exists' bool r get 'model' }
@receiver ENROLL STATUS CHANGE def award badge on enrollment sender event None user None **kwargs if badges enabled and event Enroll Status Change enroll award enrollment badge user
def vgremove vgname cmd ['vgremove' '-f' vgname]out salt ['cmd run'] cmd python shell False return out strip
def validate title value if value is None or not value strip raise Validation Value Error ' Titlecannotbeblank ' value sanitize strip html value if value is None or not value strip raise Validation Value Error ' Invalidtitle ' if len value > 200 raise Validation Value Error ' Titlecannotexceed 200 characters ' return True
def Qualify Dependencies targets all dependency sections [ dep + op for dep in dependency sections for op in '' ' ' '/' ]for target target dict in targets iteritems target build file gyp common Build File target toolset target dict['toolset']for dependency key in all dependency sections dependencies target dict get dependency key [] for index in xrange 0 len dependencies dep file dep target dep toolset gyp common Resolve Target target build file dependencies[index] toolset if not multiple toolsets dep toolset toolsetdependency gyp common Qualified Target dep file dep target dep toolset dependencies[index] dependencyif dependency key 'dependencies' and dependency not in target dict['dependencies'] raise Gyp Error ' Found' + dependency + 'in' + dependency key + 'of' + target + ' butnotindependencies'
def chrome extensions attrs None where None if salt utils is darwin return osquery cmd table 'chrome extensions' attrs attrs where where return {'result' False 'comment' ' Onlyavailableonmac O Ssystems '}
def get dvr allowed address pair device owners return [n const DEVICE OWNER LOADBALANCER n const DEVICE OWNER LOADBALANCERV 2 ]
def read tag header fid s fid read 4 * 4 if len s 0 return Nonereturn Tag *struct unpack '>i Iii' s
def read tooltips gui name dirname os path dirname file help path os path join dirname 'help' gui name + ' json' with open help path as fid raw tooltips json load fid format Text Wrapper width 60 fix sentence endings True fillreturn dict key format text for key text in raw tooltips items
def find space addr space procs mod base if addr space is valid address mod base return addr spacefor proc in procs ps ad proc get process address space if ps ad None if ps ad is valid address mod base return ps adreturn None
@contextlib contextmanagerdef temporary chown path owner uid None if owner uid is None owner uid os getuid orig uid os stat path st uidif orig uid owner uid execute 'chown' owner uid path run as root True try yield finally if orig uid owner uid execute 'chown' orig uid path run as root True
def rename name kwargs call None if call 'action' raise Salt Cloud System Exit ' Therenameactionmustbecalledwith-aor--action ' log info ' Renaming{ 0 }to{ 1 }' format name kwargs['newname'] set tags name {' Name' kwargs['newname']} call 'action' salt utils cloud rename key opts ['pki dir'] name kwargs['newname']
def set Serializer serializer global serser serializer
def queue exists queue return queue in list queues
def job delete by tag tag Job objects get tag tag delete return job get by tag tag is None
def make image square source image side settings THUMBNAIL SIZE square image Image new 'RGBA' side side 255 255 255 0 width side - source image size[ 0 ] / 2 height side - source image size[ 1 ] / 2 square image paste source image width height return square image
def all problem grade distribution request course id data {}course key Slash Separated Course Key from deprecated string course id if has instructor access for class request user course key try data dashboard data get d3 problem grade distrib course key except Exception as ex log error ' Generatingmetricsfailedwithexception %s' ex data {'error' 'error'}else data {'error' " Access Denied Userdoesnothaveaccesstothiscourse'sdata"}return Http Response json dumps data content type 'application/json'
def add Infill Boundary infill Boundary nested Rings infill Point infill Boundary[ 0 ]for nested Ring in nested Rings if euclidean is Point Inside Loop nested Ring boundary infill Point nested Ring infill Boundaries append infill Boundary return
@genericdef complete object obj prev completions raise Try Next
def virtual return 'portage config' if 'portage config get missing flags' in salt else False
def set device device if device > 0 torch C cuda set Device device
def Structure Attribute struct info cls dict dict Structure dict cls type struct info name Structure bases cls dict cls module struct info namespacecls gtype PG Type struct info g type cls size struct info sizecls is gtype struct struct info is gtype structfor method info in struct info get methods add method method info cls for field info in struct info get fields field name escape identifier field info name attr Field Attribute field name field info setattr cls field name attr return cls
def peer name if suc check name name 'a-z A-Z 0 - 9 -' raise Salt Invocation Error ' Invalidcharactersinpeername"{ 0 }"' format name cmd 'peerprobe{ 0 }' format name return gluster cmd
def virtual if HAS LIBS return virtualname else return False " The'{ 0 }'modulecouldnotbeloaded 'requests'isnotinstalled " format virtualname
def term to integer term return int '' join list map str list term 2
def do query url query err 'queryfailed' report False ua 'mps-youtube/%s %s ' % version url mpsyt opener build opener mpsyt opener addheaders [ ' User-agent' ua ]query [ k query[k] for k in sorted query keys ]url '%s?%s' % url urlencode query try wdata mpsyt opener open url read decode except URL Error HTTP Error as e g message '%s %s %s ' % err e url g content content logo c r return None if not report else None False return wdata if not report else wdata False
def get codon list codonseq full rf table codonseq get full rf table codon lst []for i k in enumerate full rf table if isinstance k int start ktry end int full rf table[ i + 1 ] except Index Error end start + 3 this codon str codonseq[start end] if len this codon 3 codon lst append this codon else codon lst append str this codon ungap elif str codonseq[int k int k + 3 ] '---' codon lst append '---' else codon lst append codonseq[int k int k + 3 ] return codon lst
def permission required perm login url None redirect REDIRECT FIELD NAME only active True redirect func lambda u not u is authenticated if only active deny func lambda u not u is active and u has perm perm else deny func lambda u not u has perm perm redirect url func lambda login url return user access decorator redirect func redirect field redirect redirect url func redirect url func deny func deny func
def load plugins extra dirs None global plugins loadedif not extra dirs extra dirs []extra dirs extend get standard plugins path start time time time load plugins from dirs extra dirs load plugins from packages fire event u'plugin register' remove event handlers u'plugin register' for plugin in list plugins values plugin initialize took time time - start time plugins loaded Truelog debug u' Pluginstook% 2fsecondstoload %spluginsinregistry ' took len plugins keys
def libvlc vlm seek media p instance psz name f percentage f Cfunctions get 'libvlc vlm seek media' None or Cfunction 'libvlc vlm seek media' 1 1 1 None ctypes c int Instance ctypes c char p ctypes c float return f p instance psz name f percentage
def iterate obj opts stack deque [obj] while stack t stack popleft yield t for c in t get children **opts stack append c
@taskdef source tarball with cd '/home/vagrant/repos/sympy' run 'gitclean-dfx' run ' /setup pyclean' run ' /setup pysdist--keep-temp' run ' /setup pybdist wininst' run 'mvdist/{win 32 -orig}dist/{win 32 }' format **tarball formatter
def which package path path abspath path prefix which prefix path if prefix is None raise Runtime Error u'couldnotdeterminecondaprefixfrom %s' % path for dist in linked prefix meta is linked prefix dist if any abspath join prefix f path for f in meta[u'files'] yield dist
def check predictions clf X y n samples len y classes np unique y n classes classes shape[ 0 ]predicted clf fit X y predict X assert array equal clf classes classes assert equal predicted shape n samples assert array equal predicted y probabilities clf predict proba X assert equal probabilities shape n samples n classes assert array almost equal probabilities sum axis 1 np ones n samples assert array equal probabilities argmax axis 1 y
def is ip addr list value min None max None return [is ip addr mem for mem in is list value min max ]
def report failed challs failed achalls problems dict for achall in failed achalls if achall error problems setdefault achall error typ [] append achall reporter zope component get Utility interfaces I Reporter for achalls in six itervalues problems reporter add message generate failed chall msg achalls reporter MEDIUM PRIORITY
def setup platform hass config add devices discovery info None devices config get CONF DEVICES lights []logger logging get Logger name if devices for entity info in devices items if entity info[scsgate CONF SCS ID] in scsgate SCSGATE devices continuename entity info[CONF NAME]scs id entity info[scsgate CONF SCS ID]logger info ' Adding%sscsgate light' name light SCS Gate Light name name scs id scs id logger logger lights append light add devices lights scsgate SCSGATE add devices to register lights
def enforce port deletion rules resource event trigger **kwargs context kwargs['context']port id kwargs['port id']subport obj trunk objects Sub Port get object context port id port id if subport obj raise trunk exc Port In Use As Sub Port port id port id trunk id subport obj trunk id trunk obj trunk objects Trunk get object context port id port id if trunk obj raise trunk exc Port In Use As Trunk Parent port id port id trunk id trunk obj id
def get script name environ if settings FORCE SCRIPT NAME is not None return force text settings FORCE SCRIPT NAME script url environ get u'SCRIPT URL' environ get u'REDIRECT URL' str u'' if script url script name script url[ - len environ get u'PATH INFO' str u'' ]else script name environ get u'SCRIPT NAME' str u'' if six PY 3 script name script name encode u'iso- 8859 - 1 ' return script name decode u'utf- 8 '
def unindent s skipfirst True lines s split '\n' if skipfirst first lines pop 0 L [first]else L []indent Nonefor l in lines ls l strip if ls indent len l - len ls break L + [l[indent ] for l in lines]return '\n' join L
def perceptron output weights bias x return step function dot weights x + bias
def users to remove source event source node new node Notification Subscription apps get model 'osf Notification Subscription' removed users {key [] for key in constants NOTIFICATION TYPES}if source node new node return removed usersold sub Notification Subscription load to subscription key source node id source event old node sub Notification Subscription load to subscription key source node id ' ' join source event split ' ' [ -2 ] if not old sub and not old node sub return removed usersfor notification type in constants NOTIFICATION TYPES users list getattr old sub notification type values list 'guids id' flat True + list getattr old node sub notification type values list 'guids id' flat True subbed removed users[notification type] separate users new node users return removed users
def scheme svg thumbnail scheme file from import schemefrom canvas import scenefrom registry import global registryscheme scheme Scheme errors []scheme load scheme scheme file error handler errors append tmp scene scene Canvas Scene tmp scene set channel names visible False tmp scene set registry global registry tmp scene set scheme scheme tmp scene anchor layout activate svg scene grab svg tmp scene tmp scene clear tmp scene delete Later return svg
def to epoch time date epoch datetime fromtimestamp 0 delta date - epoch try return int delta total seconds except Attribute Error return delta seconds + delta days * 24 * 3600
@require POST@login required@permitteddef un pin thread request course id thread id course key Course Key from string course id user cc User from django user request user thread cc Thread find thread id thread un pin user thread id return Json Response prepare content thread to dict course key
def move source destination use sudo False func use sudo and run as root or run func '/bin/mv{ 0 }{ 1 }' format quote source quote destination
def match by id items albumids item mb albumid for item in items if item mb albumid try first next albumids except Stop Iteration log debug u' Noalbum I Dfound ' return Nonefor other in albumids if other first log debug u' Noalbum I Dconsensus ' return Nonelog debug u' Searchingfordiscoveredalbum ID {0 }' first return hooks album for mbid first
def Registry Query Base sysdir key value if sys platform not in 'win 32 ' 'cygwin' return Nonecmd [os path join os environ get 'WINDIR' '' sysdir 'reg exe' 'query' key]if value cmd extend ['/v' value] p subprocess Popen cmd stdout subprocess PIPE stderr subprocess PIPE text p communicate [0 ]if p returncode return Nonereturn text
def create rule dict from obj rule return dict id rule id name rule name description rule description protocol rule protocol source port range rule source port range destination port range rule destination port range source address prefix rule source address prefix destination address prefix rule destination address prefix access rule access priority rule priority direction rule direction provisioning state rule provisioning state etag rule etag
def p4 has move command if not p4 has command 'move' return Falsecmd p4 build cmd ['move' '-k' '@from' '@to'] p subprocess Popen cmd stdout subprocess PIPE stderr subprocess PIPE out err p communicate if err find ' Invalidoption' > 0 return Falseif err find 'disabled' > 0 return Falsereturn True
def autolog message func inspect currentframe f back f codelogging debug '%s %s in%s %i' % message func co name func co filename func co firstlineno
def make decreasing candle open high low close dates **kwargs decrease x decrease y Candlestick open high low close dates **kwargs get candle decrease if 'line' in kwargs kwargs setdefault 'fillcolor' kwargs['line']['color'] else kwargs setdefault 'fillcolor' DEFAULT DECREASING COLOR kwargs setdefault 'showlegend' False kwargs setdefault 'line' dict color DEFAULT DECREASING COLOR kwargs setdefault 'name' ' Decreasing' candle decr data dict type 'box' x decrease x y decrease y whiskerwidth 0 boxpoints False **kwargs return [candle decr data]
def reverse x axes if isinstance axes int axes [axes]slices [ slice None None -1 if i in axes else slice None None None for i in range x ndim ]return x[slices]
def hex to filename path hex if getattr path 'encode' None is not None hex hex decode 'ascii' dir hex[ 2]file hex[ 2 ]return os path join path dir file
def cochrans q x return object True x np asarray x dtype np float 64 gruni np unique x N k x shapecount row success x gruni[ -1 ] sum 1 float count col success x gruni[ -1 ] sum 0 float count row ss count row success sum count col ss count col success sum assert count row ss count col ss q stat k - 1 * k * np sum count col success ** 2 - count col ss ** 2 / k * count row ss - np sum count row success ** 2 df k - 1 pvalue stats chi 2 sf q stat df if return object b Bunch b statistic q statb df dfb pvalue pvaluereturn breturn q stat pvalue df
def execute func args msg None verbose 0 dry run 0 if msg is None msg '%s%r' % func name args if msg[ -2 ] ' ' msg msg[ 0 -2 ] + ' ' log info msg if not dry run func *args
def mean image subtraction image means if image get shape ndims 3 raise Value Error ' Inputmustbeofsize[height width C> 0 ]' num channels image get shape as list [ -1 ]if len means num channels raise Value Error 'len means mustmatchthenumberofchannels' channels tf split 2 num channels image for i in range num channels channels[i] - means[i]return tf concat 2 channels
def webapi token saved cb instance created **kwargs if created op u'created'else op u'updated'mail webapi token instance op
def get configured provider return config is provider configured opts active provider name or virtualname 'token'
def interval *args def add attribute function if not hasattr function u'interval' function interval []for arg in args function interval append arg return functionreturn add attribute
def create zone manager config configuration Configuration manager volume manager opts LOG debug ' Zoningmode %s ' config safe get 'zoning mode' if config safe get 'zoning mode' 'fabric' LOG debug 'FC Zone Managerenabled ' zm fc zone manager Zone Manager if zm initialized LOG info LI ' Using FC Zone Manager% zm version s Driver% drv name s% drv version s ' {'zm version' zm get version 'drv name' zm driver class name 'drv version' zm driver get version } return zmelse LOG debug 'FC Zone Manager% zm version sdisabled' {'zm version' zm get version } return Noneelse LOG debug 'FC Zone Managernotenabledincinder conf ' return None
def Auto Legend chart chart show legend Falselabels []for series in chart data if series label is None labels append '' else labels append series label chart show legend Trueif chart show legend chart legend labels labels
def openshift img tagger registry xml parent data osb XML Sub Element xml parent 'com openshift jenkins plugins pipeline Open Shift Image Tagger' mapping [ 'api-url' 'api URL' 'https //openshift default svc cluster local' 'test-tag' 'test Tag' 'origin-nodejs-sample latest' 'prod-tag' 'prod Tag' 'origin-nodejs-sample prod' 'namespace' 'namespace' 'test' 'auth-token' 'auth Token' '' 'verbose' 'verbose' False ]convert mapping to xml osb data mapping fail required True
def authority matrix G nodelist None M nx to numpy matrix G nodelist nodelist return M T * M
def make X Axis xaxis title xaxis range xaxis graph objs X Axis title xaxis title range xaxis range showgrid False zeroline False showline False mirror False ticks '' showticklabels False return xaxis
def demo print times True print grammar False print trees True trace 2 sent ' Isaw Johnwithadogwithmycookie' numparses 5 import sys timefrom nltk parse chart import demo grammargrammar demo grammar if print grammar print '* Grammar' print grammar print '* Sentence ' print sent tokens sent split print tokens print earley Earley Chart Parser grammar trace trace t time clock chart earley chart parse tokens parses list chart parses grammar start t time clock - t if numparses assert len parses numparses ' Notallparsesfound'if print trees for tree in parses print tree else print ' Nrtrees ' len parses if print times print ' Time ' t
def instrument declarative cls registry metadata if ' decl class registry' in cls dict raise exc Invalid Request Error ' Class%ralreadyhasbeeninstrumenteddeclaratively' % cls cls decl class registry registrycls metadata metadata as declarative cls cls name cls dict
def get value val name default None **kwargs return BACKEND get value val name default **kwargs
def foldr fn elems initializer None name None if initializer is None initializer elems[ -1 ]elems elems[ -1 ]fn 2 lambda x acc fn acc x return theano foldr fn 2 elems initializer name name [0 ]
def print baremetal resource resource info resource info copy utils print dict info
def validate annotated heatmap z x y annotation text if annotation text is not None and isinstance annotation text list utils validate equal length z annotation text for lst in range len z if len z[lst] len annotation text[lst] raise exceptions Plotly Error 'zandtextshouldhavethesamedimensions' if x if len x len z[ 0 ] raise exceptions Plotly Error 'oops thexlistthatyouprovideddoesnotmatchthewidthofyourzmatrix' if y if len y len z raise exceptions Plotly Error 'oops theylistthatyouprovideddoesnotmatchthelengthofyourzmatrix'
@register tag def render template parser token tags parse ttag token ['for' 'in'] if len tags 3 raise template Template Syntax Error '%rtaghasinvalidarguments' % tags['tag name'] return Render Template Node object name tags['for'] template dir tags['in']
def df 2 idf docfreq totaldocs log base 2 0 add 0 0 return add + math log 1 0 * totaldocs / docfreq log base
def mapping get index doc type hosts None profile None es get instance hosts profile try ret es indices get mapping index index doc type doc type return retexcept elasticsearch exceptions Not Found Error return Nonereturn None
def is ava value equal attribute type val 1 val 2 return prep case insensitive val 1 prep case insensitive val 2
def apply Filter normalized uri xrd data flt None flt mk Filter flt et parse XRDS xrd data endpoints []for service element in iter Services et endpoints extend flt get Service Endpoints normalized uri service element return endpoints
@core helperdef resource view is iframed resource view view plugin datapreview get view plugin resource view['view type'] return view plugin info get 'iframed' True
def get Absolute Frozen Folder Path file Path folder Name '' if hasattr sys 'frozen' if ' py' in file Path file Path '' join file Path rpartition '\\' [ 2] file Path os path join file Path 'skeinforge application' return get Absolute Folder Path file Path folder Name
def virtual if get configured provider is False return Falsereturn virtualname
def edxnotes cls if 'edxnotes' in sys modules from edxnotes decorators import edxnotes as notesreturn notes cls else return cls
def create lrouter cluster tenant id display name nexthop tags [{'tag' tenant id 'scope' 'os tid'}]display name check and truncate name display name lrouter obj {'display name' display name 'tags' tags 'routing config' {'default route next hop' {'gateway ip address' nexthop 'type' ' Router Next Hop'} 'type' ' Single Default Route Implicit Routing Config'} 'type' ' Logical Router Config'}try return json loads do single request HTTP POST build uri path LROUTER RESOURCE json dumps lrouter obj cluster cluster except Nvp Api Client Nvp Api Exception LOG exception ' Anexceptionoccuredwhilecommunicatingwiththe NV Pcontrollerforcluster %s' cluster name raise
def writestatus text mute False if not mute and config SHOW STATUS get writeline text
def whitespace around operator logical line for match in OPERATOR REGEX finditer logical line before after match groups if ' DCTB ' in before yield match start 1 'E 223 tabbeforeoperator' elif len before > 1 yield match start 1 'E 221 multiplespacesbeforeoperator' if ' DCTB ' in after yield match start 2 'E 224 tabafteroperator' elif len after > 1 yield match start 2 'E 222 multiplespacesafteroperator'
def list nodes conn None call None if call 'action' raise Salt Cloud System Exit ' Thelist nodesfunctionmustbecalledwith-for--function ' if not conn conn get conn nodes conn list nodes ret {}for node in nodes ret[node name] {'id' node id 'image' node image 'name' node name 'private ips' node private ips 'public ips' node public ips 'size' node size 'state' node state node state }return ret
def get format format type lang None use l10 n None format type smart str format type if use l10 n or use l10 n is None and settings USE L10 N if lang is None lang get language cache key format type lang try cached format cache[cache key]if cached is not None return cachedelse return getattr settings format type except Key Error for module in get format modules lang try val getattr module format type format cache[cache key] valreturn valexcept Attribute Error pass format cache[cache key] Nonereturn getattr settings format type
def Print Usage Exit code render dict DEFAULT ARGS copy render dict['script'] os path basename sys argv[ 0 ] print sys modules[' main '] doc % render dict sys stdout flush sys exit code
def s3 store last record id tablename record id session current sessiontry record id long record id except Value Error return Falseif RCVARS not in session session[RCVARS] Storage {tablename record id} else session[RCVARS][tablename] record idreturn True
def hash file path if not os path isfile path return Falsereturn hashlib sha 1 open path 'rb' read hexdigest
def apply adjustments rgba adjustments if not adjustments return rgbafor adjustment in adjustments name args adjustment[ 0 ] adjustment[ 1 ] if name 'threshold' rgba apply threshold adjustment rgba *args elif name 'curves' rgba apply curves adjustment rgba *args elif name 'curves 2 ' rgba apply curves 2 adjustment rgba *args else raise Known Unknown ' Unrecognizedcompositeadjustment "%s"withargs%s' % name repr args return rgba
def plot window value params max times len params['times'] - params['duration'] if value > max times value len params['times'] - params['duration'] if value < 0 value 0if params['t start'] value params['t start'] valueparams['hsel patch'] set x value params['plot update proj callback'] params
@memoizedef selection model return Selection Model
def tutte graph create using None description ['adjacencylist' " Tutte's Graph" 46 [[ 2 3 4] [5 27 ] [11 12 ] [19 20 ] [6 34 ] [7 30 ] [8 28 ] [9 15 ] [10 39 ] [11 38 ] [40 ] [13 40 ] [14 36 ] [15 16 ] [35 ] [17 23 ] [18 45 ] [19 44 ] [46 ] [21 46 ] [22 42 ] [23 24 ] [41 ] [25 28 ] [26 33 ] [27 32 ] [34 ] [29 ] [30 33 ] [31 ] [32 34 ] [33 ] [] [] [36 39 ] [37 ] [38 40 ] [39 ] [] [] [42 45 ] [43 ] [44 46 ] [45 ] [] []]]G make small undirected graph description create using return G
def addpackage sitedir name known paths if known paths is None init pathinfo reset 1else reset 0fullname os path join sitedir name try f open fullname 'r U' except IO Error returnwith f for line in f if line startswith '#' continueif line startswith 'import' 'import DCTB ' exec linecontinueline line rstrip dir dircase makepath sitedir line if not dircase in known paths and os path exists dir sys path append dir known paths add dircase if reset known paths Nonereturn known paths
def dump obj fp skipkeys False ensure ascii True check circular True allow nan True cls None indent None separators None encoding 'utf- 8 ' default None **kw if skipkeys is False and ensure ascii is True and check circular is True and allow nan is True and cls is None and indent is None and separators is None and encoding 'utf- 8 ' and default is None and not kw iterable default encoder iterencode obj else if cls is None cls JSON Encoderiterable cls skipkeys skipkeys ensure ascii ensure ascii check circular check circular allow nan allow nan indent indent separators separators encoding encoding default default **kw iterencode obj for chunk in iterable fp write chunk
def assert Raises Exactly cls fn *args **kwargs try fn *args **kwargs except Exception as e assert e class cls 'got%s expected%s' % e class name cls name else raise Assertion Error '%snotraised' % cls
def build image data cmap 'gray' import matplotlib pyplot as pltfrom matplotlib figure import Figurefrom matplotlib backends backend agg import Figure Canvas Agg as Figure Canvasfigsize data shape[ -1 ]if figsize[ 0 ] 1 figsize tuple figsize[ 1 ] data data[ 0]fig Figure figsize figsize dpi 1 0 frameon False Figure Canvas fig cmap getattr plt cm cmap plt cm gray fig figimage data cmap cmap output Bytes IO fig savefig output dpi 1 0 format 'png' return base 64 b64 encode output getvalue decode 'ascii'
def run on executor fn @functools wraps fn def wrapper self *args **kwargs callback kwargs pop 'callback' None future self executor submit fn self *args **kwargs if callback self io loop add future future lambda future callback future result return futurereturn wrapper
def expanded data n 100 expanded training data network 3 load data shared ' /data/mnist expanded pkl gz' for j in range 3 print ' Trainingwithexpandeddata %sneuronsinthe F Clayer runnum%s' % n j net Network [ Conv Pool Layer image shape mini batch size 1 28 28 filter shape 20 1 5 5 poolsize 2 2 activation fn Re LU Conv Pool Layer image shape mini batch size 20 12 12 filter shape 40 20 5 5 poolsize 2 2 activation fn Re LU Fully Connected Layer n in 40 * 4 * 4 n out n activation fn Re LU Softmax Layer n in n n out 10 ] mini batch size net SGD expanded training data 60 mini batch size 0 03 validation data test data lmbda 0 1 return net
@login requireddef save transcripts request response {'status' ' Error'}data json loads request GET get 'data' '{}' if not data return error response response ' Incomingvideodataisempty ' try item get item request data except Invalid Key Error Item Not Found Error return error response response " Can'tfinditembylocator " metadata data get 'metadata' if metadata is not None new sub metadata get 'sub' for metadata key value in metadata items setattr item metadata key value item save with metadata request user if new sub manage video subtitles save item request user else current subs data get 'current subs' if current subs is not None for sub in current subs remove subs from store sub item response['status'] ' Success'return Json Response response
def find subdirectories package try subdirectories next os walk package to path package [1 ]except Stop Iteration subdirectories []return subdirectories
@publicdef poly from expr expr *gens **args opt options build options gens args return poly from expr expr opt
@gen enginedef List All Keys store callback prefix None marker None batch size 1000 batch size min 1000 batch size keys []done Falsewhile not done new keys yield gen Task store List Keys prefix prefix marker marker maxkeys batch size keys extend new keys if len new keys < batch size breakmarker new keys[ -1 ]callback keys
def make tag list n 26 lc string lowercaselc len len lc return [{'name' lc[ i % lc len ] * int math ceil i / lc len + 2 } for i in range 0 n ]
def get free range parent range excluded ranges size PRIMARY VIP RANGE SIZE free cidrs netaddr IP Set [parent range] - netaddr IP Set excluded ranges for cidr in free cidrs iter cidrs if cidr prefixlen < size return '%s/%s' % cidr network size raise Value Error ' Networkofsize% size s from I Prange% parent range sexcluding I Pranges% excluded ranges swasnotfound ' % {'size' size 'parent range' parent range 'excluded ranges' excluded ranges}
def authenticate cram md 5 credentials sock info source credentials sourceusername credentials usernamepassword credentials passwordpasswd password digest username password cmd SON [ 'sasl Start' 1 'mechanism' 'CRAM-MD 5 ' 'payload' Binary '' 'auto Authorize' 1 ] response sock info command source cmd mac hmac HMAC key passwd encode 'utf- 8 ' digestmod md 5 mac update response['payload'] challenge username encode 'utf- 8 ' + '' + b mac hexdigest cmd SON [ 'sasl Continue' 1 'conversation Id' response['conversation Id'] 'payload' Binary challenge ] sock info command source cmd
def set dirty using None if using is None using DEFAULT DB ALIA Sconnection connections[using]connection set dirty
def test make imbalance 2 X y make imbalance X Y ratio 0 25 min c 1 counter Counter y assert equal counter[ 0 ] 500 assert equal counter[ 1 ] 125 assert true np all [ X i in X for X i in X ]
def element in child binder root e return any x typeid startswith 'bind ' for x in root path to e
def flavor delete flavor id profile None conn auth profile return conn flavor delete flavor id
def Doc Test Suite module None globs None extraglobs None test finder None **options if test finder is None test finder Doc Test Finder module normalize module module tests test finder find module globs globs extraglobs extraglobs if not tests and sys flags optimize > 2 suite unittest Test Suite suite add Test Skip Doc Test Case return suiteelif not tests raise Value Error module 'hasnotests' tests sort suite unittest Test Suite for test in tests if len test examples 0 continueif not test filename filename module file if filename[ -4 ] in ' pyc' ' pyo' filename filename[ -1 ]test filename filenamesuite add Test Doc Test Case test **options return suite
def user roles exists name roles database user None password None host None port None authdb None try roles to dict roles except Exception return ' Rolesprovidedinwrongformat'users user list user password host port database authdb if isinstance users string types return ' Failedtoconnecttomongodatabase'for user in users if name dict user get 'user' for role in roles if not isinstance role dict role {'role' role 'db' database}if role not in dict user get 'roles' [] return Falsereturn Truereturn False
def merge insert ins chunks doc unbalanced start balanced unbalanced end split unbalanced ins chunks doc extend unbalanced start if doc and not doc[ -1 ] endswith '' doc[ -1 ] + ''doc append '<ins>' if balanced and balanced[ -1 ] endswith '' balanced[ -1 ] balanced[ -1 ][ -1 ]doc extend balanced doc append '</ins>' doc extend unbalanced end
def extract task features task features ['task type' 'task input' 'task id' 'requester' 'task state']task feature dict {feature str getattr task feature for feature in features}task feature dict['created'] task created isoformat duration sec 'unknown'if hasattr task 'task output' and task task output is not None try task output json loads task task output except Value Error log error ' Couldnotparsetaskoutputasvalidjson taskoutput %s' task task output else if 'duration ms' in task output duration sec int task output['duration ms'] / 1000 0 task feature dict['duration sec'] duration sec success task message get task completion info task status ' Complete' if success else ' Incomplete' task feature dict['status'] statustask feature dict['task message'] task messagereturn task feature dict
def get section display name course id course modulestore get course course id depth 4 section display name [''] * len course get children i 0for section in course get children section display name[i] own metadata section get 'display name' '' i + 1return section display name
def displayable path path separator u' ' if isinstance path list tuple return separator join displayable path p for p in path elif isinstance path six text type return pathelif not isinstance path bytes return six text type path try return path decode fsencoding 'ignore' except Unicode Error Lookup Error return path decode 'utf- 8 ' 'ignore'
def history not changed proc TIMEOUT proc send '\x 1 b[A' assert proc expect [TIMEOUT u'fuck']
def fig to vega fig notebook False renderer Vega Renderer Exporter renderer run fig vega html Vega HTML renderer if notebook return vega htmlelse return vega html html
def ss to index ss if ss 'H' return 0if ss 'E' return 1if ss 'C' return 2assert 0
def basics match original result modified result return all getattr original result member getattr modified result member for member in ['origin' 'message' 'severity' 'debug msg']
def prepopulated fields js context prepopulated fields []if context['add'] and 'adminform' in context prepopulated fields extend context['adminform'] prepopulated fields if 'inline admin formsets' in context for inline admin formset in context['inline admin formsets'] for inline admin form in inline admin formset if inline admin form original is None prepopulated fields extend inline admin form prepopulated fields context update {'prepopulated fields' prepopulated fields} return context
def get notifications user notifications []try user idexcept return []try if not getattr settings 'HARDTREE ALLOW GRITTER NOTIFICATIONS' False return notificationsrequest Http Request request user userstorage default storage request for msg in storage get [0 ] notifications append {'message' msg message 'tags' msg get tags } storage store None except passreturn notifications
def chopstring message key n funcref msglen len message mbits msglen * 8 nbits int math floor math log n 2 nbytes nbits / 8 blocks msglen / nbytes if msglen % nbytes > 0 blocks + 1cypher []for bindex in range blocks offset bindex * nbytes block message[offset offset + nbytes ]value bytes 2 int block cypher append funcref value key n return picklechops cypher
def prepare data filename tmp prefix dbargs osm 2 pgsql projection args osm 2 pgsql split + ['--create' '--merc' '--prefix' tmp prefix] for flag key in [ '-d' 'database' '-U' 'user' '-W' 'password' '-H' 'host' ] if key in dbargs args + flag dbargs[key] args + [filename]create Popen args stderr PIPE stdout PIPE create wait assert create returncode 0 " It'simportantthatosm 2 pgsqlactuallyworked " + create stderr read
@pytest fixturedef template name return 'cookiedozer'
def validate user data user data try user data base 64 b64 decode user data except Type Error return Falsereturn True
def test debug stdout logging caplog debug logger debug messages [stream handler] debug logger handlersassert isinstance stream handler logging Stream Handler assert stream handler level logging DEBUG create log records stream messages [stream handler format r for r in caplog records if r levelno > stream handler level ]assert stream messages debug messages
def fnmatch name pat name os path normcase name pat os path normcase pat return fnmatchcase name pat
@cronjobs registerdef reindex users that contributed yesterday if settings STAGE returntoday datetime now yesterday today - timedelta days 1 user ids list Answer objects filter created gte yesterday created lt today values list 'creator id' flat True user ids + list Revision objects filter created gte yesterday created lt today values list 'creator id' flat True user ids + list Revision objects filter reviewed gte yesterday reviewed lt today values list 'reviewer id' flat True index task delay User Mapping Type list set user ids
def css *args return '\n' join [stylesheet link url for '/static/style/%s css?v %s' % name server starttime for name in args]
def logout request next page None template name 'registration/logged out html' redirect field name REDIRECT FIELD NAME current app None extra context None auth logout request if redirect field name in request REQUEST next page request REQUEST[redirect field name]if not is safe url url next page host request get host next page request pathif next page return Http Response Redirect next page current site get current site request context {'site' current site 'site name' current site name 'title' ' Loggedout' }if extra context is not None context update extra context return Template Response request template name context current app current app
def transform bilogistic t beta delta def check args beta delta cond 1 beta > 0 and beta < 1 and delta > 0 and delta < 1 cond 2 beta < 0 and delta < 0 return cond 1 cond 2 if not np all check args beta delta raise Value Error 'invalidargs' def integrant w term 1 1 - beta * np power w - beta * 1 - t term 2 1 - delta * np power 1 - w - delta * t np maximum term 1 term 2 from scipy integrate import quadtransf quad integrant 0 1 return transf
def l2 regularizer weight 1 0 scope None def regularizer tensor with tf name scope scope 'L 2 Regularizer' [tensor] l2 weight tf convert to tensor weight dtype tensor dtype base dtype name 'weight' return tf multiply l2 weight tf nn l2 loss tensor name 'value' return regularizer
@log call@utils no 4byte paramsdef metadef tag update context namespace name id values global DAT Anamespace metadef namespace get context namespace name check namespace visibility context namespace namespace name tag metadef tag get by id context namespace name id if tag['name'] values['name'] for db tag in DATA['metadef tags'] if db tag['name'] values['name'] and db tag['namespace id'] namespace['id'] LOG debug ' Invalidupdate Itwouldresultinaduplicatemetadatadefinitiontagwithsamename % name sinnamespace % namespace name s ' {'name' tag['name'] 'namespace name' namespace name} raise exception Metadef Duplicate Tag name tag['name'] namespace name namespace name DATA['metadef tags'] remove tag tag update values tag['updated at'] timeutils utcnow DATA['metadef tags'] append tag return tag
def html unescape t return encode decode htmldecode t
def run task task name args None kwargs None broker None backend None wait for result False timeout None propagate True interval 0 5 no ack True raise timeout True config None if not broker raise Salt Invocation Error 'brokerparameterisrequired' with Celery broker broker backend backend set as current False as app if config app conf update config with app connection args args or [] kwargs kwargs or {} async result app send task task name args args kwargs kwargs if wait for result try return async result get timeout timeout propagate propagate interval interval no ack no ack except Timeout Error as ex log error ' Waitingfortheresultofacelerytaskexecutiontimedout ' if raise timeout raise exreturn False
def poly TC f K if not f return K zeroelse return f[ -1 ]
def uses shib course return course enrollment domain and course enrollment domain startswith settings SHIBBOLETH DOMAIN PREFIX
def getenv sep ' ' if os name 'nt' else ' ' env os environ copy sys path insert 0 GAMEDIR env['PYTHONPATH'] sep join sys path return env
def mt spectra x dpss sfreq n fft None if n fft is None n fft x shape[ 1 ]x x - np mean x axis -1 [ np newaxis] freqs fftpack fftfreq n fft 1 0 / sfreq freq mask freqs > 0 freqs freqs[freq mask]n tapers dpss shape[ 0 ] if dpss ndim > 1 else 1 x mt np zeros len x n tapers freq mask sum dtype np complex 128 for idx sig in enumerate x x mt[idx] fftpack fft sig[np newaxis ] * dpss n n fft [ freq mask]return x mt freqs
def get Locked Handle runtime Element expression full Expression ' import "nupic bindings research" fromlist ["lock Handle"] lock Handle ' + expression + ' ' return runtime Element interpret full Expression
def define db conn db host port user passwd dal 'db DAL "oracle //%s/%s@%s %s/%s" pool size 10 'print dal % user passwd host port db printprint 'migrate False'printfor table in get tables conn define table conn table
def get qiime temp dir return load qiime config ['temp dir']
def graded scorable blocks to header course key scorable blocks map Ordered Dict grading context grading context for course course key for assignment type name subsection infos in grading context['all graded subsections by type'] iteritems for subsection index subsection info in enumerate subsection infos start 1 for scorable block in subsection info['scored descendants'] header name u'{assignment type}{subsection index} {subsection name}-{scorable block name}' format scorable block name scorable block display name assignment type assignment type name subsection index subsection index subsection name subsection info['subsection block'] display name scorable blocks map[scorable block location] [ header name + ' Earned ' header name + ' Possible ' ]return scorable blocks map
@pytest fixturedef hass loop hass loop run until complete async test home assistant loop yield hass loop run until complete hass async stop
def get account id from arn trail arn return trail arn split ' ' [4 ]
def p expression name t try t[ 0 ] names[t[ 1 ]]except Lookup Error print u" Undefinedname'%s'" % t[ 1 ] t[ 0 ] 0
def remove result ranges diffs result list file dict result diff dict dict {}for original result in result list mod file dict copy deepcopy file dict source ranges []previous Nonefor source range in sorted original result affected code reverse True if previous is not None and source range overlaps previous combined sr Source Range join previous source range previous combined srelif previous is None previous source rangeelse source ranges append previous previous source rangeif previous source ranges append previous for source range in source ranges file name source range filenew file remove range mod file dict[file name] source range mod file dict[file name] new filediff dict {}for file name in file dict diff dict[file name] Diff from string arrays file dict[file name] mod file dict[file name] result diff dict dict[original result] diff dictreturn result diff dict dict
def get temp dir temp get environ variable 'TMP' if temp None temp get environ variable 'TEMP' if temp None or '' in temp and os name 'nt' temp 'C \\temp'if temp None or '' in temp and os name 'posix' temp '/tmp'return temp
def exec command all *cmdargs **kwargs proc subprocess Popen cmdargs bufsize -1 stdout subprocess PIPE stderr subprocess PIPE **kwargs out err proc communicate if is py 3 encoding kwargs get 'encoding' if encoding out out decode encoding err err decode encoding else out os fsdecode out err os fsdecode err return proc returncode out err
def mask sequence seq maskchar fpos tpos if len maskchar > 1 raise Runtime Error ' Internalerror morethanonecharactergiventomask sequence' if fpos < 0 fpos 0if tpos > len seq tpos len seq newseq '' join seq[ fpos] maskchar * tpos - fpos seq[tpos ] return newseq
def backwards apps schema editor certificate html view configuration model apps get model u'certificates' u' Certificate Html View Configuration' certificate html view configuration model objects all delete
def do format value *args **kwargs if args and kwargs raise Filter Argument Error "can'thandlepositionalandkeywordargumentsatthesametime" return soft unicode value % kwargs or args
def run executor sql join False expanded False pgspecial None exception formatter None results executor run sql pgspecial exception formatter formatted []for title rows headers status sql success in results formatted extend format output title rows headers status 'psql' dcmlfmt 'd' floatfmt 'g' expanded expanded if join formatted '\n' join formatted return formatted
def Install Library name version explicit True installed version explicitly installed installed get name [ None] * 2 if name in sys modules if explicit Check Installed Version name version explicit True returnelif installed version if version installed version returnif explicit if explicitly installed raise Value Error '%s%srequested but%salreadyinuse' % name version installed version Remove Library name else version ob distutils version Loose Version version installed ob distutils version Loose Version installed version if version ob < installed ob returnelse Remove Library name Add Library name version explicit dep details PACKAGES[name][ 1 ][version]if not dep details returnfor dep name dep version in dep details Install Library dep name dep version explicit False
def getdefaultencoding prefer stream True enc Noneif prefer stream enc get stream enc sys stdin if not enc or enc 'ascii' try enc locale getpreferredencoding except Exception passenc enc or sys getdefaultencoding if enc 'cp 0 ' warnings warn ' Invalidcodepagecp 0 detected-usingcp 1252 instead Ifcp 1252 isincorrectpleaseensureavalidcodepageisdefinedfortheprocess ' Runtime Warning return 'cp 1252 'return enc
@coroutinedef component 1 reactor session yield session expose api
def envs branch repo location gitpil Legacy Git Pillar branch repo location opts return gitpil envs
def lookup Nameservers name timeout None return get Resolver lookup Nameservers name timeout
def emit via redis event message room r get redis server try r publish u'events' frappe as json {u'event' event u'message' message u'room' room} except redis exceptions Connection Error pass
def mc 2 mnc mc n len mc mean mc[ 0 ]mc [1 ] + list mc mc[ 1 ] 0mnc [1 mean]for nn m in enumerate mc[ 2 ] n nn + 2 mnc append 0 for k in range n + 1 mnc[n] + comb n k exact 1 * mc[k] * mean ** n - k return mnc[ 1 ]
def get Key M row column prefix '' return '%sm%s%s' % prefix row + 1 column + 1
@csrf exempt@require post@has request variablesdef api dev fetch api key request username REQ if not dev auth enabled or settings PRODUCTION return json error ' Devenvironmentnotenabled ' return data {}user profile authenticate username username realm subdomain get subdomain request return data return data if return data get 'inactive realm' return json error ' Yourrealmhasbeendeactivated ' data {'reason' 'realmdeactivated'} status 403 if return data get 'inactive user' return json error ' Youraccounthasbeendisabled ' data {'reason' 'userdisable'} status 403 login request user profile return json success {'api key' user profile api key 'email' user profile email}
def version syslog ng sbin dir None try ret run command in extended path syslog ng sbin dir 'syslog-ng' '-V' except Command Execution Error as err return format return data retcode -1 stderr str err if ret['retcode'] 0 return format return data ret['retcode'] stderr ret['stderr'] stdout ret['stdout'] lines ret['stdout'] split '\n' version line index 0version column index 1line lines[version line index] split [version column index]return format return data 0 stdout line
def test short users list u1 User Profile username 'oscar' display name ' Oscarthe Grouch' pk 1 u2 User Profile username 'grover' display name ' Grover' pk 2 u3 User Profile username 'cookies ' display name ' Cookie Monster' pk 3 shortlist users list [u 1 u2 u3 ] size 2 assert shortlist ' ' join user link u1 user link u2 + ' others'
def findall pattern string flags 0 return compile pattern flags findall string
def load tweets filename try archive open filename 'r' except IO Error return {}tweets {}for line in archive readlines try tid text line strip split '' 1 tweets[int tid ] text decode 'utf- 8 ' except Exception as e err 'loadingtweet%sfaileddueto%s' % line unicode e archive close return tweets
@ Profiler profiledef test core reuse stmt compiled cache n compiled cache {}stmt select [ Customer table ] where Customer id bindparam 'id' with engine connect execution options compiled cache compiled cache as conn for id in random sample ids n row conn execute stmt id id first tuple row
def To Channel Error error error map {channel service pb Channel Service Error INVALID CHANNEL KEY Invalid Channel Client Id Error channel service pb Channel Service Error BAD MESSAGE Invalid Message Error channel service pb Channel Service Error APPID ALIAS REQUIRED App Id Alias Required}if error application error in error map return error map[error application error] error error detail else return error
def assert all instances list class label 'object' for obj in list or [] assert instance obj class label 'object'
def process sms outbox msg process outbox contact method 'SMS'
def sh escape command command command replace '\\' '\\\\' command command replace '$' '\\$' command command replace '"' '\\"' command command replace '`' '\\`' return command